### الاستعلامات (Queries)

#### GetClosingReportByIdQuery
استرجاع تقرير إغلاق محدد بواسطة الرقم التعريفي.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم للوصول للتقرير
- التحقق من وجود التقرير المطلوب
- استرجاع بيانات التقرير الأساسية
- استرجاع أقسام التقرير المرتبطة
- استرجاع الملاحظات والمرفقات
- استرجاع معلومات الاعتماد إن وجدت
- تطبيق تصفية البيانات حسب صلاحيات المستخدم

#### GetAvailableClosingReportsQuery
استرجاع قائمة تقارير الإغلاق المتاحة مع إمكانية التصفية.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم للوصول لقائمة التقارير
- تطبيق معايير التصفية (الفترة، النوع، الحالة)
- ترتيب النتائج حسب المعايير المحددة
- تصفية النتائج حسب صلاحيات المستخدم
- تجميع التقارير حسب التصنيف إذا طلب
- استرجاع الأعداد الإجمالية لعرض إحصائيات
- تطبيق تقسيم الصفحات للنتائج

#### GetClosingReportTemplatesQuery
استرجاع قوالب تقارير الإغلاق المتاحة.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم للوصول لقوالب التقارير
- تصفية القوالب حسب صلاحيات المستخدم
- استرجاع القوالب الخاصة بالمستخدم والقوالب العامة
- تصنيف القوالب حسب النوع أو الاستخدام
- استرجاع معلومات الاستخدام لكل قالب
- ترتيب النتائج حسب المعايير المحددة

#### GetClosingReportSchedulesQuery
استرجاع جدولة تقارير الإغلاق.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم للوصول لجداول التقارير
- تصفية الجداول حسب حالتها وتاريخ تنفيذها
- استرجاع معلومات الجدولة مع التقارير المرتبطة
- تحديد الجداول التي ستنفذ قريبًا
- استرجاع سجل تنفيذ الجداول السابقة
- تصفية النتائج حسب صلاحيات المستخدم

#### GetClosingReportHistoryQuery
استرجاع تاريخ تغييرات تقرير إغلاق.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم للوصول لتاريخ التقرير
- التحقق من وجود التقرير المطلوب
- استرجاع سجل التغييرات على التقرير
- استرجاع معلومات المستخدمين والتواريخ
- استرجاع تفاصيل التغييرات والإصدارات
- ترتيب النتائج حسب تسلسل التاريخ
- تطبيق تصفية على نوع التغييرات إذا طلب

#### GetFavoriteClosingReportsQuery
استرجاع تقارير الإغلاق المفضلة للمستخدم.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم
- استرجاع قائمة التقارير المفضلة للمستخدم الحالي
- استرجاع معلومات التقارير المرتبطة
- ترتيب النتائج حسب الاستخدام أو معايير أخرى
- استرجاع معلومات آخر استخدام لكل تقرير
- تصفية النتائج حسب الحالة إذا طلب

#### GetRecentClosingReportsQuery
استرجاع تقارير الإغلاق المستخدمة مؤخرًا.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم
- استرجاع قائمة التقارير المستخدمة مؤخرًا
- تحديد فترة "المستخدمة مؤخرًا" حسب إعدادات النظام
- ترتيب النتائج حسب تاريخ آخر استخدام
- تصفية النتائج المكررة
- استرجاع معلومات الإجراء الأخير على كل تقرير
- تصفية النتائج حسب صلاحيات المستخدم

## منطق الأعمال والتحققات

### فحص الصلاحيات
- تحقق من صلاحيات المستخدم للوصول لتقارير الإغلاق
- تحقق من صلاحيات إنشاء وتعديل التقارير
- تحقق من صلاحيات اعتماد التقارير
- تحقق من صلاحيات تصدير ومشاركة التقارير
- تطبيق تصفية النتائج حسب صلاحيات المستخدم
- تطبيق صلاحيات خاصة للتقارير الحساسة

### تحققات البيانات
- التحقق من صحة واكتمال معايير التقارير
- تحقق من اتساق البيانات في تقارير المقارنة
- تحقق من صحة تحويلات العملات في التقارير متعددة العملات
- التحقق من توازن البيانات المالية في التقارير
- التحقق من صحة التواريخ والفترات المحاسبية
- تطبيق قواعد التقريب والتنسيق حسب إعدادات النظام

### حالات خاصة
- معالجة الفترات المحاسبية المغلقة جزئياً
- معالجة البيانات التي تتجاوز حدود الفترة المحددة
- معالجة التقارير التي تتضمن بيانات من أكثر من سنة مالية
- معالجة حالات تغيير العملة الأساسية
- التعامل مع تقارير الفترات المقارنة غير المتساوية
- معالجة حالات عدم توفر بعض البيانات للفترات السابقة

### استراتيجيات تحميل البيانات
- تحميل بيانات التقارير على مراحل لتحسين الأداء
- استخدام التخزين المؤقت للنتائج المستخدمة بشكل متكرر
- تطبيق استراتيجيات تأجيل تحميل البيانات التفصيلية
- تنفيذ عمليات المعالجة الثقيلة في الخلفية
- تحميل البيانات التاريخية حسب الحاجة فقط
- تطبيق استراتيجيات تجميع البيانات المسبق لتحسين الأداء

### تكامل البيانات
- تجميع البيانات من مصادر متعددة بشكل متسق
- التحقق من اتساق التصنيفات والترميز بين المصادر المختلفة
- معالجة اختلافات السياسات المحاسبية بين الفروع
- تطبيق قواعد التوافق مع المعايير المحاسبية المعتمدة
- ضمان سلامة البيانات أثناء تبادلها بين الأنظمة المختلفة
- توحيد تنسيق البيانات المستوردة

### إدارة الأداء
- تحسين أداء استعلامات التقارير الكبيرة
- تطبيق استراتيجيات التصفية المبكرة للبيانات
- تقسيم توليد التقارير الكبيرة إلى مهام متوازية
- تطبيق فهرسة مناسبة لتحسين زمن الاستجابة
- جدولة توليد التقارير المعقدة في أوقات انخفاض الحمل
- تطبيق حدود على كمية البيانات المعروضة دفعة واحدة

### تجربة المستخدم
- تقديم ردود فعل مناسبة أثناء توليد التقارير الكبيرة
- عرض مؤشرات تقدم واضحة للعمليات طويلة الأمد
- حفظ تفضيلات المستخدم لتحسين تجربة الاستخدام
- تقديم خيارات مناسبة لتخصيص عرض التقارير
- توفير رسائل خطأ واضحة ومفيدة
- تقديم اقتراحات ذكية بناءً على تاريخ استخدام المستخدم

## اختصارات لوحة المفاتيح وأزرار الشاشة السريعة

### اختصارات لوحة المفاتيح العامة
- **F1**: عرض المساعدة الخاصة بشاشة تقارير الإغلاق
- **F2**: فتح نافذة البحث عن تقرير
- **F3**: تحديث البيانات المعروضة
- **F5**: إعادة توليد التقرير الحالي
- **F6**: فتح نافذة معايير التقرير
- **F8**: حفظ التقرير الحالي
- **F10**: تصدير التقرير الحالي
- **F11**: طباعة التقرير الحالي
- **F12**: إغلاق نافذة التقرير الحالية
- **Ctrl+N**: إنشاء تقرير جديد
- **Ctrl+O**: فتح تقرير محفوظ
- **Ctrl+S**: حفظ التقرير الحالي
- **Ctrl+P**: طباعة التقرير الحالي
- **Ctrl+E**: تصدير التقرير الحالي
- **Ctrl+B**: إضافة/إزالة التقرير من المفضلة
- **Ctrl+F**: البحث في محتوى التقرير
- **Ctrl+G**: الانتقال إلى قسم محدد في التقرير
- **Ctrl+I**: عرض معلومات التقرير
- **Ctrl+H**: عرض تاريخ التغييرات
- **Ctrl+R**: تحديث بيانات التقرير

### اختصارات التنقل في التقرير
- **الأسهم**: التنقل بين خلايا البيانات
- **Page Up/Down**: التنقل بين صفحات التقرير
- **Home**: الانتقال إلى بداية التقرير
- **End**: الانتقال إلى نهاية التقرير
- **Tab**: الانتقال بين حقول الإدخال
- **Ctrl+Home**: الانتقال إلى الصفحة الأولى
- **Ctrl+End**: الانتقال إلى الصفحة الأخيرة
- **Alt+Arrow Left/Right**: التنقل بين أقسام التقرير
- **Ctrl+Tab**: التنقل بين التقارير المفتوحة
- **Ctrl+Shift+Tab**: التنقل بين التقارير المفتوحة (عكسي)

### اختصارات عرض التقرير
- **Ctrl++**: تكبير العرض
- **Ctrl+-**: تصغير العرض
- **Ctrl+0**: إعادة ضبط حجم العرض
- **Alt+1-9**: تبديل بين تخطيطات العرض المختلفة
- **Alt+G**: تبديل عرض الرسوم البيانية
- **Alt+T**: تبديل عرض الجداول
- **Alt+C**: تبديل عرض الملخصات
- **Alt+D**: تبديل وضع العرض المفصل/الملخص
- **Alt+F**: توسيع/طي جميع المجموعات

### أزرار الوصول السريع في شريط الأدوات
- **زر إنشاء تقرير جديد**: إنشاء تقرير جديد من نوع محدد
- **زر قوائم التقارير المفضلة**: عرض قائمة التقارير المفضلة
- **زر التقارير الأخيرة**: عرض قائمة التقارير المستخدمة مؤخراً
- **زر قوالب التقارير**: عرض وتطبيق قوالب التقارير المحفوظة
- **زر حفظ المعايير**: حفظ معايير التقرير الحالية للاستخدام لاحقاً
- **زر إعدادات العرض**: تخصيص إعدادات عرض التقرير
- **زر تغيير نمط العرض**: التبديل بين أنماط العرض المختلفة
- **زر جدولة التقرير**: إعداد جدولة إنشاء وتوزيع التقرير
- **زر مشاركة التقرير**: مشاركة التقرير مع مستخدمين آخرين
- **زر التاريخ والإصدارات**: عرض تاريخ التغييرات والإصدارات

### أزرار الوظائف المتخصصة
- **زر المقارنة**: تنشيط وضع مقارنة الفترات
- **زر التحليل**: الوصول لأدوات التحليل المتقدمة
- **زر المراجعة والتدقيق**: فتح أدوات المراجعة والتدقيق
- **زر الملاحظات والتعليقات**: إدارة ملاحظات وتعليقات التقرير
- **زر التنبيهات**: إعداد وإدارة تنبيهات مرتبطة بالتقرير
- **زر التصدير المهيكل**: تصدير البيانات بتنسيقات مهيكلة
- **زر معالجة البيانات**: تطبيق عمليات معالجة خاصة على البيانات
- **زر الاعتماد والتوقيع**: إرسال التقرير للاعتماد أو توقيعه
- **زر الإصدارات**: إدارة إصدارات متعددة من التقرير
- **زر الأمن والصلاحيات**: إدارة صلاحيات الوصول للتقرير
- **زر الاستخدام الذكي**: الوصول للميزات الذكية والتعلم الآلي

### أزرار مؤشرات الحالة
- **مؤشر حالة البيانات**: يوضح حالة تحديث البيانات
- **مؤشر حالة الاعتماد**: يوضح حالة اعتماد التقرير
- **مؤشر المراجعة**: يوضح حالة مراجعة التقرير
- **مؤشر الوصول**: يوضح صلاحيات المستخدم للتقرير
- **مؤشر المشاركة**: يوضح عدد المستخدمين المشارك معهم التقرير
- **مؤشر الجدولة**: يوضح حالة جدولة التقرير
- **مؤشر الإشعارات**: يوضح وجود إشعارات مرتبطة بالتقرير 