# شاشة إعدادات السنة المالية (Fiscal Year Settings)

## نظرة عامة
شاشة إعدادات السنة المالية هي إحدى الشاشات الأساسية في نظام الأونكس برو ERP، وتتيح للمستخدمين إنشاء وإدارة السنوات المالية والفترات المحاسبية. تُعد هذه الإعدادات حجر الأساس لكافة العمليات المحاسبية في النظام حيث تحدد الإطار الزمني الذي يتم خلاله تنظيم وتسجيل المعاملات المالية وإعداد التقارير. من خلال هذه الشاشة، يمكن للمستخدمين تحديد بداية ونهاية السنة المالية، وتقسيمها إلى فترات محاسبية (شهرية، ربع سنوية، أو مخصصة)، وإدارة عمليات فتح وإغلاق الفترات المحاسبية لضمان دقة البيانات المالية.

## مكونات واجهة المستخدم

### القسم العلوي (إدارة السنوات المالية)
- **العنوان**: عنوان الشاشة "إعدادات السنة المالية"
- **قائمة السنوات المالية**: قائمة بالسنوات المالية المعرفة في النظام
- **مؤشر السنة المالية الحالية**: تمييز للسنة المالية الحالية
- **حالة السنة المالية**: مؤشر حالة كل سنة مالية (مفتوحة، مغلقة، قيد الإعداد)
- **زر إنشاء سنة مالية جديدة**: لإضافة سنة مالية جديدة
- **زر تعديل السنة المالية**: لتعديل بيانات السنة المالية المحددة
- **زر حذف سنة مالية**: لإزالة سنة مالية غير مستخدمة
- **زر تحديد السنة المالية الحالية**: لتعيين السنة المالية الحالية
- **زر نسخ إعدادات سنة مالية**: لنسخ إعدادات سنة مالية موجودة
- **شريط البحث السريع**: للبحث عن سنة مالية محددة

### قسم تفاصيل السنة المالية
- **رمز السنة المالية**: الرمز الفريد للسنة المالية (مثل FY2023)
- **اسم السنة المالية**: الاسم الوصفي للسنة المالية
- **اسم السنة المالية بالإنجليزية**: الاسم الإنجليزي للسنة المالية
- **تاريخ البداية**: تاريخ بداية السنة المالية
- **تاريخ النهاية**: تاريخ نهاية السنة المالية
- **المدة**: مدة السنة المالية بالأيام (تُحسب تلقائياً)
- **التقويم المستخدم**: نوع التقويم المستخدم (ميلادي، هجري، أو مالي مخصص)
- **حالة السنة المالية**: حالة السنة المالية (مفتوحة، مغلقة، قيد الإعداد)
- **ملاحظات**: ملاحظات إضافية حول السنة المالية
- **معلومات الإنشاء**: اسم المستخدم وتاريخ إنشاء السنة المالية
- **معلومات آخر تعديل**: اسم المستخدم وتاريخ آخر تعديل للسنة المالية

### قسم الفترات المحاسبية
- **جدول الفترات المحاسبية**: عرض لجميع الفترات المحاسبية ضمن السنة المالية المحددة
- **رقم الفترة**: الرقم التسلسلي للفترة ضمن السنة المالية
- **رمز الفترة**: الرمز المميز للفترة (مثل P01-2023)
- **اسم الفترة**: الاسم الوصفي للفترة
- **تاريخ البداية**: تاريخ بداية الفترة المحاسبية
- **تاريخ النهاية**: تاريخ نهاية الفترة المحاسبية
- **نوع الفترة**: تصنيف الفترة (شهرية، ربع سنوية، نصف سنوية، مخصصة)
- **حالة الفترة**: حالة الفترة المحاسبية (مفتوحة، مقفلة مؤقتاً، مقفلة نهائياً)
- **رمز الفترة في التقويم**: الربط مع التقويم المالي
- **ملاحظات الفترة**: ملاحظات إضافية حول الفترة المحاسبية

### قسم الإعدادات المتقدمة للسنة المالية
- **نمط ترقيم الفترات**: نمط ترقيم الفترات المحاسبية
- **فترة الإقفال الافتراضية**: الفترة الافتراضية لترحيل قيود الإقفال
- **إعدادات ترحيل الأرصدة**: خيارات ترحيل الأرصدة للسنة المالية الجديدة
- **حسابات الإقفال**: تحديد الحسابات المستخدمة في عمليات إقفال السنة المالية
- **سياسات عامة للسنة المالية**: إعدادات عامة تطبق على كل الفترات
- **سياسات تأمين البيانات**: إعدادات تأمين وحماية بيانات الفترات المغلقة
- **قواعد التحذير والتنبيه**: إعدادات التحذيرات المتعلقة بالفترات المحاسبية

### شريط أدوات إدارة الفترات المحاسبية
- **زر إنشاء فترات تلقائياً**: إنشاء فترات محاسبية بشكل تلقائي حسب نمط محدد
- **زر إضافة فترة يدوياً**: إضافة فترة محاسبية بشكل يدوي
- **زر تعديل فترة**: تعديل بيانات الفترة المحاسبية المحددة
- **زر حذف فترة**: حذف فترة محاسبية غير مستخدمة
- **زر فتح الفترة**: فتح فترة محاسبية للسماح بإدخال القيود عليها
- **زر إغلاق مؤقت للفترة**: إغلاق مؤقت للفترة مع إمكانية إعادة فتحها
- **زر إغلاق نهائي للفترة**: إغلاق نهائي للفترة بدون إمكانية إعادة فتحها

### منطقة العرض والإحصائيات
- **الرسم البياني للفترات**: تمثيل بياني للفترات المحاسبية وحالتها
- **مؤشرات الأداء**: مؤشرات لعرض إحصائيات عن القيود والحركات في كل فترة
- **ملخص الأرصدة**: ملخص لأرصدة الحسابات الرئيسية في كل فترة
- **مؤشر الفترة الحالية**: تمييز للفترة المحاسبية الحالية
- **عداد القيود**: عدد القيود المحاسبية المسجلة في كل فترة
- **الإشارات التحذيرية**: إشارات لتنبيه المستخدم حول مشاكل محتملة في الفترات

## الوظائف الرئيسية

### إدارة السنوات المالية
1. **إنشاء سنة مالية جديدة**: إنشاء سنة مالية جديدة مع تحديد تاريخ البداية والنهاية
2. **تعديل سنة مالية**: تعديل بيانات سنة مالية موجودة (قبل وجود حركات عليها)
3. **حذف سنة مالية**: حذف سنة مالية غير مستخدمة
4. **نسخ إعدادات سنة مالية**: نسخ إعدادات سنة مالية موجودة إلى سنة مالية جديدة
5. **تفعيل/تعطيل سنة مالية**: تغيير حالة السنة المالية بين مفعلة ومعطلة
6. **تحديد السنة المالية الافتراضية**: تعيين السنة المالية الافتراضية للعمل عليها
7. **ترحيل الأرصدة بين السنوات المالية**: نقل أرصدة الحسابات من سنة مالية إلى أخرى

### إدارة الفترات المحاسبية
1. **إنشاء الفترات المحاسبية تلقائياً**: إنشاء فترات محاسبية تلقائياً حسب نمط محدد
2. **إضافة فترة محاسبية يدوياً**: إضافة فترة محاسبية يدوياً مع تحديد جميع بياناتها
3. **تعديل فترة محاسبية**: تعديل بيانات فترة محاسبية موجودة
4. **حذف فترة محاسبية**: حذف فترة محاسبية غير مستخدمة
5. **تغيير حالة الفترة المحاسبية**: تغيير حالة الفترة بين (مفتوحة، مغلقة مؤقتاً، مغلقة نهائياً)
6. **تحديد الفترة المحاسبية الحالية**: تعيين الفترة المحاسبية الحالية للعمل عليها
7. **إعادة فتح فترة مغلقة مؤقتاً**: إمكانية إعادة فتح فترة تم إغلاقها مؤقتاً
8. **توزيع القيود بين الفترات**: توزيع قيود محاسبية بين فترات مختلفة

### دورة حياة السنة المالية والفترات
1. **تهيئة سنة مالية جديدة**: إعداد سنة مالية جديدة مع كافة التفاصيل والإعدادات
2. **فتح السنة المالية**: تفعيل السنة المالية للبدء بإدخال البيانات والمعاملات
3. **إغلاق مؤقت للسنة المالية**: إغلاق مؤقت للسنة المالية مع إمكانية إعادة فتحها
4. **إغلاق نهائي للسنة المالية**: إغلاق نهائي للسنة المالية بعد انتهاء جميع العمليات المحاسبية
5. **إعادة فتح سنة مالية مغلقة مؤقتاً**: إعادة فتح سنة مالية تم إغلاقها مؤقتاً
6. **عمليات الإقفال وترحيل الأرصدة**: إجراء عمليات الإقفال ونقل الأرصدة للسنة التالية

### وظائف خاصة
1. **إعدادات التقويم المالي**: تحديد نوع التقويم المستخدم وإعداداته
2. **سياسات الفترات المحاسبية**: تحديد سياسات التعامل مع الفترات المحاسبية
3. **إدارة صلاحيات الفترات**: تحديد صلاحيات المستخدمين على الفترات المختلفة
4. **تأمين بيانات الفترات المغلقة**: حماية بيانات الفترات المغلقة من التعديل
5. **تقارير الفترات والسنوات المالية**: تقارير إحصائية وتحليلية عن الفترات والسنوات المالية
6. **التدقيق والمراجعة**: أدوات للتدقيق والمراجعة للفترات والسنوات المالية
7. **التنبيهات والإشعارات**: إعداد تنبيهات آلية متعلقة بالفترات المحاسبية (قرب الإغلاق، إلخ)

### وظائف الإدارة والتقارير
1. **مراقبة حالة الفترات**: متابعة حالة جميع الفترات المحاسبية وإدارتها
2. **تقارير أداء الفترات**: تقارير عن أداء العمليات المالية حسب الفترات
3. **تقارير المقارنة بين الفترات**: مقارنة الأداء المالي بين فترات مختلفة
4. **سجل الإجراءات**: سجل بجميع الإجراءات المتعلقة بالسنوات والفترات المالية
5. **لوحة معلومات الفترات**: لوحة إحصائية شاملة عن الفترات المحاسبية

## العمليات المتقدمة

### التعامل مع أنواع مختلفة من السنوات المالية
- **السنة المالية الميلادية**: التي تبدأ في 1 يناير وتنتهي في 31 ديسمبر
- **السنة المالية الهجرية**: التي تعتمد على التقويم الهجري
- **السنة المالية المخصصة**: التي تبدأ وتنتهي في تواريخ مخصصة
- **السنة المالية المقسمة**: التي تتداخل مع سنتين ميلاديتين (مثل ابريل-مارس)
- **إعدادات التحويل التلقائي**: تحويل التواريخ بين الأنظمة المختلفة
- **معالجة السنوات الكبيسة**: التعامل مع الفروقات في السنوات الكبيسة
- **معالجة فروق التقويمات**: معالجة الفروقات بين التقويمات المختلفة

### إدارة أنماط الفترات المحاسبية
- **الفترات الشهرية**: تقسيم السنة المالية إلى 12 فترة شهرية
- **الفترات ربع السنوية**: تقسيم السنة المالية إلى 4 فترات ربع سنوية
- **الفترات نصف السنوية**: تقسيم السنة المالية إلى فترتين نصف سنويتين
- **الفترات المخصصة**: تقسيم السنة المالية إلى فترات بأطوال مختلفة
- **إنشاء الفترات آلياً**: إنشاء فترات محاسبية تلقائياً حسب النمط المحدد
- **معالجة الفترات المتداخلة**: التعامل مع الفترات المتداخلة بين السنوات
- **إعدادات السنة المالية 13**: إضافة فترة إضافية للتسويات الختامية
- **التحقق من تغطية الفترات**: التأكد من تغطية الفترات لكامل السنة المالية

### عمليات الإقفال وترحيل الأرصدة
- **إقفال الإيرادات والمصروفات**: ترحيل أرصدة حسابات الإيرادات والمصروفات إلى حسابات النتيجة
- **إقفال حسابات النتيجة**: ترحيل رصيد حساب النتيجة إلى الأرباح المحتجزة
- **ترحيل أرصدة الميزانية**: نقل أرصدة حسابات الميزانية للسنة المالية الجديدة
- **التعامل مع الأرصدة الافتتاحية**: إنشاء قيود الأرصدة الافتتاحية للسنة الجديدة
- **التحقق من صحة الترحيل**: التأكد من صحة عمليات الترحيل وتوازن القيود
- **سجل عمليات الإقفال**: الاحتفاظ بسجل تفصيلي لعمليات الإقفال والترحيل
- **خيارات الإقفال المرنة**: توفير خيارات متعددة لعمليات الإقفال
- **إقفال وترحيل البنود المفتوحة**: التعامل مع البنود المفتوحة عند الإقفال
- **معالجة فروق التقريب**: معالجة فروق التقريب في عمليات الإقفال والترحيل

### إدارة التسويات والقيود الختامية
- **قيود نهاية الفترة**: إدارة القيود الخاصة بنهاية الفترة المحاسبية
- **قيود الاستحقاق الآلية**: إنشاء قيود الاستحقاق آلياً عند نهاية الفترة
- **قيود التسويات الأوتوماتيكية**: إنشاء قيود التسويات بصورة آلية
- **قيود تحويل العملات**: القيود الخاصة بتسوية أرصدة العملات الأجنبية
- **إدارة المخصصات**: تسجيل وإدارة المخصصات في نهاية الفترة
- **توزيع المصاريف المقدمة**: توزيع المصاريف المدفوعة مقدماً على الفترات
- **معالجة الإيرادات المؤجلة**: توزيع الإيرادات المحصلة مقدماً على الفترات
- **التسويات المحاسبية المعقدة**: معالجة التسويات المحاسبية المعقدة
- **سياسات التسويات التلقائية**: ضبط قواعد إنشاء التسويات التلقائية

### إدارة تأمين البيانات والحماية
- **سياسات قفل الفترات**: تحديد قواعد وسياسات قفل الفترات المحاسبية
- **صلاحيات إعادة فتح الفترات**: تحديد صلاحيات إعادة فتح الفترات المغلقة
- **حماية القيود المحاسبية**: منع تعديل القيود في الفترات المغلقة
- **التأمين متعدد المستويات**: مستويات متعددة من التأمين للفترات
- **سجل تغييرات حالة الفترات**: توثيق جميع التغييرات على حالة الفترات
- **التأمين الانتقائي**: تأمين أنواع محددة من المعاملات في الفترات
- **صلاحيات الإقفال النهائي**: التحكم بصلاحيات الإقفال النهائي للفترات
- **استثناءات التأمين**: إدارة الاستثناءات في تأمين الفترات
- **سياسات الاحتفاظ بالبيانات**: تحديد قواعد الاحتفاظ بالبيانات للفترات المغلقة

### إدارة الصلاحيات والتحكم
- **مستويات الصلاحيات**: تحديد مستويات مختلفة للصلاحيات على الفترات
- **صلاحيات على مستوى الفترة**: إمكانية إعطاء صلاحيات مختلفة لكل فترة
- **صلاحيات على مستوى السنة**: إعطاء صلاحيات على مستوى السنة المالية
- **صلاحيات خاصة للإقفال**: صلاحيات خاصة لعمليات الإقفال وإعادة الفتح
- **صلاحيات التسويات**: التحكم بصلاحيات إجراء التسويات في نهاية الفترة
- **الصلاحيات الاستثنائية**: إدارة الصلاحيات الاستثنائية للحالات الخاصة
- **سجل استخدام الصلاحيات**: توثيق استخدام الصلاحيات على الفترات
- **صلاحيات الفترات السابقة**: التحكم بالوصول للفترات المالية السابقة

### الارتباط مع الشاشات الأخرى
- **الارتباط مع القيود المحاسبية**: التحقق من الفترة المحاسبية عند إنشاء القيود
- **الارتباط مع دليل الحسابات**: التحقق من الحسابات النشطة في كل فترة
- **الارتباط مع الموازنات التقديرية**: ربط الموازنات التقديرية بالفترات المالية
- **الارتباط مع التقارير المالية**: إنشاء التقارير المالية حسب الفترات
- **الارتباط مع شاشة المستخدمين**: ربط صلاحيات المستخدمين بالفترات
- **الارتباط مع شاشة الفروع**: تحديد إعدادات الفترات المالية لكل فرع
- **الارتباط مع شاشة إعدادات الشركة**: استخدام إعدادات الشركة في تكوين السنة المالية
- **الارتباط مع شاشة العملات**: ربط أسعار العملات بتواريخ الفترات
- **الارتباط مع شاشة الضرائب**: ضبط الفترات الضريبية بما يتوافق مع الفترات المحاسبية

## مكونات طبقة التطبيق

### الكيانات (Entities)

#### FiscalYear (السنة المالية)
الكيان الرئيسي الذي يمثل السنة المالية ويحتوي على:
- رقم التعريف (ID)
- رمز السنة المالية (Code)
- اسم السنة المالية (NameAr)
- اسم السنة المالية بالإنجليزية (NameEn)
- تاريخ البداية (StartDate)
- تاريخ النهاية (EndDate)
- المدة بالأيام (Duration)
- نوع التقويم (CalendarType)
- حالة السنة المالية (Status)
- السنة المالية الافتراضية (IsDefault)
- نمط ترقيم الفترات (PeriodNumberingPattern)
- حساب الأرباح المحتجزة (RetainedEarningsAccountId)
- حساب نتيجة النشاط (IncomeStatementAccountId)
- ملاحظات (Notes)
- معلومات الإنشاء (CreatedBy, CreationDate)
- معلومات التعديل (UpdatedBy, UpdateDate)
- إعدادات الترحيل (CarryOverSettings)
- إعدادات التأمين (LockSettings)

#### FiscalPeriod (الفترة المحاسبية)
كيان يمثل فترة محاسبية ضمن السنة المالية ويحتوي على:
- رقم التعريف (ID)
- رقم السنة المالية (FiscalYearId)
- رقم الفترة (PeriodNumber)
- رمز الفترة (Code)
- اسم الفترة (NameAr)
- اسم الفترة بالإنجليزية (NameEn)
- تاريخ البداية (StartDate)
- تاريخ النهاية (EndDate)
- نوع الفترة (PeriodType)
- حالة الفترة (Status)
- الفترة الافتراضية للإقفال (IsClosingDefault)
- رمز الفترة في التقويم (CalendarReference)
- تاريخ آخر إغلاق (LastClosingDate)
- تاريخ آخر إعادة فتح (LastReopenDate)
- ملاحظات (Notes)
- معلومات الإنشاء (CreatedBy, CreationDate)
- معلومات التعديل (UpdatedBy, UpdateDate)

#### FiscalYearSetting (إعدادات السنة المالية)
كيان يمثل الإعدادات المتقدمة للسنة المالية:
- رقم التعريف (ID)
- رقم السنة المالية (FiscalYearId)
- نوع الإعداد (SettingType)
- اسم الإعداد (SettingName)
- قيمة الإعداد (SettingValue)
- وصف الإعداد (Description)
- تاريخ التطبيق (EffectiveDate)
- حالة الإعداد (Status)
- معلومات الإنشاء (CreatedBy, CreationDate)
- معلومات التعديل (UpdatedBy, UpdateDate)

#### FiscalYearClosing (إقفال السنة المالية)
كيان يمثل عملية إقفال السنة المالية:
- رقم التعريف (ID)
- رقم السنة المالية (FiscalYearId)
- تاريخ الإقفال (ClosingDate)
- نوع الإقفال (ClosingType)
- حالة الإقفال (Status)
- المستخدم المنفذ (PerformedBy)
- رقم قيد الإقفال (ClosingJournalEntryId)
- ملاحظات (Notes)
- سجل الإجراءات (ActionLog)
- معلومات الإنشاء (CreatedBy, CreationDate)
- معلومات التعديل (UpdatedBy, UpdateDate)

#### FiscalPeriodLock (تأمين الفترة المحاسبية)
كيان يمثل عملية تأمين الفترة المحاسبية:
- رقم التعريف (ID)
- رقم الفترة المحاسبية (FiscalPeriodId)
- تاريخ التأمين (LockDate)
- نوع التأمين (LockType)
- سبب التأمين (LockReason)
- المستخدم المنفذ (PerformedBy)
- حالة التأمين (Status)
- استثناءات التأمين (Exceptions)
- ملاحظات (Notes)
- معلومات الإنشاء (CreatedBy, CreationDate)
- معلومات التعديل (UpdatedBy, UpdateDate)

#### FiscalPeriodAdjustment (تسويات الفترة المحاسبية)
كيان يمثل التسويات المحاسبية للفترة:
- رقم التعريف (ID)
- رقم الفترة المحاسبية (FiscalPeriodId)
- نوع التسوية (AdjustmentType)
- تاريخ التسوية (AdjustmentDate)
- حالة التسوية (Status)
- رقم قيد التسوية (AdjustmentJournalEntryId)
- وصف التسوية (Description)
- المستخدم المنفذ (PerformedBy)
- ملاحظات (Notes)
- معلومات الإنشاء (CreatedBy, CreationDate)
- معلومات التعديل (UpdatedBy, UpdateDate)

### الأوامر (Commands)

#### CreateFiscalYearCommand (أمر إنشاء سنة مالية جديدة)
- **الغرض**: إنشاء سنة مالية جديدة في النظام
- **المدخلات الرئيسية**: رمز السنة المالية، اسم السنة المالية، تاريخ البداية، تاريخ النهاية، نوع التقويم
- **العمليات**: إنشاء سجل سنة مالية جديدة مع الإعدادات الافتراضية
- **منطق الأعمال والتحققات**:
  - التحقق من تفرد رمز السنة المالية
  - التحقق من صحة تواريخ البداية والنهاية (النهاية يجب أن تكون بعد البداية)
  - التحقق من عدم تداخل الفترة مع سنوات مالية أخرى
  - التحقق من صلاحيات المستخدم لإنشاء سنة مالية
  - إنشاء الإعدادات الافتراضية للسنة المالية
  - تعيين السنة المالية كافتراضية إذا كانت الأولى في النظام
  - تسجيل العملية في سجل النشاط

#### UpdateFiscalYearCommand (أمر تحديث سنة مالية)
- **الغرض**: تحديث بيانات سنة مالية موجودة
- **المدخلات الرئيسية**: معرف السنة المالية، البيانات المراد تحديثها
- **العمليات**: تحديث بيانات السنة المالية المحددة
- **منطق الأعمال والتحققات**:
  - التحقق من وجود السنة المالية
  - التحقق من صلاحيات المستخدم لتعديل السنة المالية
  - التحقق من إمكانية تعديل السنة المالية (عدم وجود فترات مغلقة نهائياً)
  - التحقق من عدم وجود تداخل مع سنوات مالية أخرى في حالة تغيير التواريخ
  - التحقق من توافق التعديلات مع الفترات المحاسبية المرتبطة
  - تسجيل التغييرات في سجل النشاط

#### DeleteFiscalYearCommand (أمر حذف سنة مالية)
- **الغرض**: حذف سنة مالية غير مستخدمة
- **المدخلات الرئيسية**: معرف السنة المالية
- **العمليات**: حذف السنة المالية والفترات المرتبطة بها
- **منطق الأعمال والتحققات**:
  - التحقق من وجود السنة المالية
  - التحقق من صلاحيات المستخدم لحذف السنة المالية
  - التحقق من عدم وجود قيود محاسبية مرتبطة بالسنة المالية
  - التحقق من عدم وجود عمليات ترحيل أو إقفال مرتبطة بالسنة المالية
  - حذف الفترات المحاسبية المرتبطة بالسنة المالية
  - حذف الإعدادات المرتبطة بالسنة المالية
  - تسجيل العملية في سجل النشاط

#### SetDefaultFiscalYearCommand (أمر تعيين السنة المالية الافتراضية)
- **الغرض**: تعيين سنة مالية محددة كسنة افتراضية
- **المدخلات الرئيسية**: معرف السنة المالية
- **العمليات**: تعيين السنة المالية المحددة كافتراضية وإلغاء الإعداد من السنة الافتراضية السابقة
- **منطق الأعمال والتحققات**:
  - التحقق من وجود السنة المالية
  - التحقق من صلاحيات المستخدم لتغيير السنة المالية الافتراضية
  - التحقق من حالة السنة المالية (يجب أن تكون مفتوحة)
  - إلغاء الإعداد الافتراضي من السنة المالية الافتراضية السابقة
  - تعيين السنة المالية الجديدة كافتراضية
  - تسجيل العملية في سجل النشاط

#### CopyFiscalYearCommand (أمر نسخ إعدادات سنة مالية)
- **الغرض**: نسخ إعدادات سنة مالية موجودة إلى سنة مالية جديدة
- **المدخلات الرئيسية**: معرف السنة المالية المصدر، بيانات السنة المالية الجديدة
- **العمليات**: إنشاء سنة مالية جديدة باستخدام إعدادات السنة المصدر
- **منطق الأعمال والتحققات**:
  - التحقق من وجود السنة المالية المصدر
  - التحقق من صلاحيات المستخدم لإنشاء سنة مالية جديدة
  - التحقق من تفرد رمز السنة المالية الجديدة
  - نسخ الإعدادات المتقدمة وتكوين الفترات المحاسبية
  - تعديل التواريخ لتتناسب مع السنة المالية الجديدة
  - تسجيل العملية في سجل النشاط

#### ChangeFiscalYearStatusCommand (أمر تغيير حالة سنة مالية)
- **الغرض**: تغيير حالة السنة المالية (مفتوحة، مغلقة، قيد الإعداد)
- **المدخلات الرئيسية**: معرف السنة المالية، الحالة الجديدة
- **العمليات**: تحديث حالة السنة المالية
- **منطق الأعمال والتحققات**:
  - التحقق من وجود السنة المالية
  - التحقق من صلاحيات المستخدم لتغيير حالة السنة المالية
  - التحقق من إمكانية تغيير الحالة حسب الحالة الحالية والفترات المرتبطة
  - تنفيذ أي إجراءات مطلوبة لتغيير الحالة (مثل إغلاق الفترات المفتوحة عند إغلاق السنة)
  - تسجيل العملية في سجل النشاط

#### CreatePeriodsAutomaticallyCommand (أمر إنشاء فترات محاسبية تلقائياً)
- **الغرض**: إنشاء فترات محاسبية تلقائياً للسنة المالية
- **المدخلات الرئيسية**: معرف السنة المالية، نمط الفترات، عدد الفترات
- **العمليات**: إنشاء فترات محاسبية بشكل تلقائي بناءً على النمط المحدد
- **منطق الأعمال والتحققات**:
  - التحقق من وجود السنة المالية
  - التحقق من صلاحيات المستخدم لإضافة فترات محاسبية
  - التحقق من عدم وجود فترات موجودة مسبقاً (أو معالجتها حسب سياسة النظام)
  - إنشاء الفترات حسب النمط المحدد (شهرية، ربع سنوية، نصف سنوية)
  - التأكد من تغطية الفترات لكامل مدة السنة المالية
  - تعيين حالة الفترات بناءً على حالة السنة المالية
  - تسجيل العملية في سجل النشاط

#### CreatePeriodManuallyCommand (أمر إنشاء فترة محاسبية يدوياً)
- **الغرض**: إضافة فترة محاسبية يدوياً للسنة المالية
- **المدخلات الرئيسية**: معرف السنة المالية، بيانات الفترة المحاسبية
- **العمليات**: إنشاء فترة محاسبية جديدة بالبيانات المحددة
- **منطق الأعمال والتحققات**:
  - التحقق من وجود السنة المالية
  - التحقق من صلاحيات المستخدم لإضافة فترات محاسبية
  - التحقق من تفرد رمز الفترة ضمن السنة المالية
  - التحقق من أن تواريخ الفترة تقع ضمن نطاق السنة المالية
  - التحقق من عدم تداخل الفترة مع فترات محاسبية أخرى
  - تسجيل العملية في سجل النشاط

#### UpdatePeriodCommand (أمر تحديث فترة محاسبية)
- **الغرض**: تحديث بيانات فترة محاسبية
- **المدخلات الرئيسية**: معرف الفترة المحاسبية، البيانات المحدثة
- **العمليات**: تحديث بيانات الفترة المحاسبية المحددة
- **منطق الأعمال والتحققات**:
  - التحقق من وجود الفترة المحاسبية
  - التحقق من صلاحيات المستخدم لتعديل الفترة المحاسبية
  - التحقق من إمكانية تعديل الفترة (غير مغلقة نهائياً)
  - التحقق من بقاء تواريخ الفترة ضمن نطاق السنة المالية
  - التحقق من عدم تداخل التواريخ المحدثة مع فترات أخرى
  - تسجيل التغييرات في سجل النشاط

#### ChangePeriodStatusCommand (أمر تغيير حالة فترة محاسبية)
- **الغرض**: تغيير حالة فترة محاسبية (مفتوحة، مغلقة مؤقتاً، مغلقة نهائياً)
- **المدخلات الرئيسية**: معرف الفترة المحاسبية، الحالة الجديدة
- **العمليات**: تحديث حالة الفترة المحاسبية
- **منطق الأعمال والتحققات**:
  - التحقق من وجود الفترة المحاسبية
  - التحقق من صلاحيات المستخدم لتغيير حالة الفترة
  - التحقق من إمكانية تغيير الحالة حسب الحالة الحالية
  - تنفيذ الإجراءات المطلوبة عند تغيير الحالة (مثل عمليات التسوية والتدقيق)
  - تحديث تاريخ الإغلاق أو إعادة الفتح حسب الحالة الجديدة
  - تسجيل العملية في سجل النشاط

#### CloseFiscalYearCommand (أمر إقفال السنة المالية)
- **الغرض**: إجراء عملية إقفال السنة المالية
- **المدخلات الرئيسية**: معرف السنة المالية، نوع الإقفال، بيانات الإقفال
- **العمليات**: تنفيذ عملية إقفال السنة المالية وترحيل الأرصدة
- **منطق الأعمال والتحققات**:
  - التحقق من وجود السنة المالية
  - التحقق من صلاحيات المستخدم لإقفال السنة المالية
  - التحقق من إمكانية إقفال السنة (إغلاق جميع الفترات)
  - إنشاء قيود إقفال الإيرادات والمصروفات
  - ترحيل الأرصدة للسنة المالية التالية
  - تحديث حالة السنة المالية
  - إنشاء سجل لعملية الإقفال
  - تسجيل العملية في سجل النشاط

#### ReopenFiscalYearCommand (أمر إعادة فتح سنة مالية)
- **الغرض**: إعادة فتح سنة مالية مغلقة مؤقتاً
- **المدخلات الرئيسية**: معرف السنة المالية، سبب إعادة الفتح
- **العمليات**: إعادة فتح السنة المالية وتحديث حالتها
- **منطق الأعمال والتحققات**:
  - التحقق من وجود السنة المالية
  - التحقق من صلاحيات المستخدم لإعادة فتح السنة المالية
  - التحقق من أن السنة المالية مغلقة مؤقتاً وليست نهائياً
  - إلغاء تأثير عمليات الإقفال السابقة إذا لزم الأمر
  - تحديث حالة السنة المالية والفترات المرتبطة
  - تسجيل سبب إعادة الفتح وتاريخه
  - تسجيل العملية في سجل النشاط

#### CarryOverBalancesCommand (أمر ترحيل الأرصدة)
- **الغرض**: ترحيل أرصدة الحسابات من سنة مالية إلى أخرى
- **المدخلات الرئيسية**: معرف السنة المالية المصدر، معرف السنة المالية الهدف، إعدادات الترحيل
- **العمليات**: نقل أرصدة الحسابات من سنة مالية إلى أخرى
- **منطق الأعمال والتحققات**:
  - التحقق من وجود السنتين الماليتين
  - التحقق من صلاحيات المستخدم لترحيل الأرصدة
  - التحقق من أن السنة المالية المصدر مغلقة أو جاهزة للترحيل
  - التحقق من أن السنة المالية الهدف مفتوحة وجاهزة لاستقبال الأرصدة
  - تحديد الحسابات التي سيتم ترحيل أرصدتها حسب إعدادات الترحيل
  - إنشاء قيود الأرصدة الافتتاحية في السنة المالية الهدف
  - تسجيل العملية في سجل النشاط 

### الاستعلامات (Queries)

#### GetFiscalYearByIdQuery (استعلام للحصول على سنة مالية بالرقم التعريفي)
- **الغرض**: استرجاع معلومات سنة مالية محددة بواسطة الرقم التعريفي
- **المدخلات**: معرف السنة المالية
- **المخرجات**: بيانات السنة المالية كاملة
- **منطق الأعمال والتحققات**:
  - التحقق من صلاحيات المستخدم للوصول للسنة المالية
  - استرجاع البيانات المرتبطة (الفترات المحاسبية، الإعدادات)

#### GetFiscalYearByCodeQuery (استعلام للحصول على سنة مالية بالرمز)
- **الغرض**: استرجاع معلومات سنة مالية محددة بواسطة الرمز
- **المدخلات**: رمز السنة المالية
- **المخرجات**: بيانات السنة المالية كاملة
- **منطق الأعمال والتحققات**:
  - التحقق من صلاحيات المستخدم للوصول للسنة المالية
  - استرجاع البيانات المرتبطة (الفترات المحاسبية، الإعدادات)

#### ListFiscalYearsQuery (استعلام لعرض قائمة السنوات المالية)
- **الغرض**: استرجاع قائمة بالسنوات المالية حسب معايير محددة
- **المدخلات**: معايير التصفية، خيارات الترتيب، معلومات الصفحات
- **المخرجات**: قائمة بالسنوات المالية مع معلوماتها الأساسية
- **منطق الأعمال والتحققات**:
  - التحقق من صلاحيات المستخدم للوصول للسنوات المالية
  - تصفية النتائج حسب المعايير المحددة
  - تطبيق الترتيب والصفحات حسب الطلب

#### GetDefaultFiscalYearQuery (استعلام للحصول على السنة المالية الافتراضية)
- **الغرض**: استرجاع معلومات السنة المالية الافتراضية
- **المدخلات**: لا توجد
- **المخرجات**: بيانات السنة المالية الافتراضية
- **منطق الأعمال والتحققات**:
  - التحقق من صلاحيات المستخدم للوصول للسنة المالية
  - التحقق من وجود سنة مالية افتراضية في النظام

#### GetCurrentFiscalPeriodQuery (استعلام للحصول على الفترة المحاسبية الحالية)
- **الغرض**: استرجاع معلومات الفترة المحاسبية الحالية
- **المدخلات**: معرف السنة المالية (اختياري)
- **المخرجات**: بيانات الفترة المحاسبية الحالية
- **منطق الأعمال والتحققات**:
  - التحقق من صلاحيات المستخدم للوصول للفترة المحاسبية
  - إذا لم يتم تحديد سنة مالية، يتم استخدام السنة المالية الافتراضية
  - تحديد الفترة الحالية بناءً على التاريخ الحالي

#### GetPeriodByDateQuery (استعلام للحصول على فترة محاسبية بالتاريخ)
- **الغرض**: استرجاع معلومات الفترة المحاسبية التي تشمل تاريخ محدد
- **المدخلات**: التاريخ، معرف السنة المالية (اختياري)
- **المخرجات**: بيانات الفترة المحاسبية
- **منطق الأعمال والتحققات**:
  - التحقق من صلاحيات المستخدم للوصول للفترة المحاسبية
  - إذا لم يتم تحديد سنة مالية، يتم استخدام السنة المالية الافتراضية
  - تحديد الفترة التي يقع فيها التاريخ المحدد

#### GetFiscalPeriodByIdQuery (استعلام للحصول على فترة محاسبية بالرقم التعريفي)
- **الغرض**: استرجاع معلومات فترة محاسبية محددة بواسطة الرقم التعريفي
- **المدخلات**: معرف الفترة المحاسبية
- **المخرجات**: بيانات الفترة المحاسبية كاملة
- **منطق الأعمال والتحققات**:
  - التحقق من صلاحيات المستخدم للوصول للفترة المحاسبية
  - استرجاع البيانات المرتبطة (التسويات، عمليات التأمين)

#### ListFiscalPeriodsQuery (استعلام لعرض قائمة الفترات المحاسبية)
- **الغرض**: استرجاع قائمة بالفترات المحاسبية حسب معايير محددة
- **المدخلات**: معرف السنة المالية، معايير التصفية، خيارات الترتيب
- **المخرجات**: قائمة بالفترات المحاسبية مع معلوماتها
- **منطق الأعمال والتحققات**:
  - التحقق من صلاحيات المستخدم للوصول للفترات المحاسبية
  - تصفية النتائج حسب المعايير المحددة
  - تطبيق الترتيب حسب الطلب

#### GetFiscalYearSettingsQuery (استعلام للحصول على إعدادات سنة مالية)
- **الغرض**: استرجاع إعدادات سنة مالية محددة
- **المدخلات**: معرف السنة المالية، نوع الإعدادات (اختياري)
- **المخرجات**: قائمة بإعدادات السنة المالية
- **منطق الأعمال والتحققات**:
  - التحقق من صلاحيات المستخدم للوصول لإعدادات السنة المالية
  - تصفية الإعدادات حسب النوع إذا تم تحديده

#### GetFiscalYearStatisticsQuery (استعلام للحصول على إحصائيات سنة مالية)
- **الغرض**: استرجاع إحصائيات وملخص للسنة المالية
- **المدخلات**: معرف السنة المالية
- **المخرجات**: إحصائيات عن القيود والحركات في السنة المالية
- **منطق الأعمال والتحققات**:
  - التحقق من صلاحيات المستخدم للوصول لإحصائيات السنة المالية
  - تجميع البيانات الإحصائية من مختلف مصادر البيانات

#### GetFiscalPeriodAdjustmentsQuery (استعلام للحصول على تسويات فترة محاسبية)
- **الغرض**: استرجاع تسويات فترة محاسبية محددة
- **المدخلات**: معرف الفترة المحاسبية، نوع التسويات (اختياري)
- **المخرجات**: قائمة بتسويات الفترة المحاسبية
- **منطق الأعمال والتحققات**:
  - التحقق من صلاحيات المستخدم للوصول لتسويات الفترة
  - تصفية التسويات حسب النوع إذا تم تحديده

#### CheckPeriodStatusForDateQuery (استعلام للتحقق من حالة الفترة لتاريخ محدد)
- **الغرض**: التحقق من حالة الفترة المحاسبية لتاريخ محدد
- **المدخلات**: التاريخ، معرف السنة المالية (اختياري)
- **المخرجات**: معلومات عن الفترة المحاسبية وحالتها
- **منطق الأعمال والتحققات**:
  - تحديد الفترة المحاسبية التي يقع فيها التاريخ
  - التحقق من حالة الفترة (مفتوحة، مغلقة مؤقتاً، مغلقة نهائياً)
  - تقديم معلومات إضافية عن إمكانية إدخال قيود في هذا التاريخ

## اختصارات لوحة المفاتيح وأزرار الشاشة السريعة

### اختصارات لوحة المفاتيح
- **F2**: إنشاء سنة مالية جديدة
- **F3**: تعديل السنة المالية المحددة
- **F4**: عرض تفاصيل السنة المالية المحددة
- **F5**: تحديث قائمة السنوات المالية
- **F6**: تعيين السنة المالية المحددة كافتراضية
- **F7**: عرض الفترات المحاسبية للسنة المالية المحددة
- **F8**: إنشاء فترات محاسبية تلقائياً
- **F9**: تغيير حالة السنة المالية
- **F10**: عرض إحصائيات السنة المالية
- **F11**: تنفيذ عملية إقفال السنة المالية
- **F12**: ترحيل أرصدة السنة المالية
- **Ctrl+S**: حفظ التغييرات
- **Ctrl+Z**: إلغاء التغييرات
- **Ctrl+F**: البحث في السنوات المالية
- **Ctrl+P**: طباعة بيانات السنة المالية أو الفترات
- **Ctrl+E**: تصدير بيانات السنوات المالية
- **Ctrl+I**: استيراد بيانات السنوات المالية
- **Alt+X**: إغلاق الشاشة

### اختصارات في شاشة الفترات المحاسبية
- **F2**: إضافة فترة محاسبية جديدة
- **F3**: تعديل الفترة المحاسبية المحددة
- **F4**: عرض تفاصيل الفترة المحاسبية
- **F5**: تحديث قائمة الفترات المحاسبية
- **F6**: فتح الفترة المحاسبية المحددة
- **F7**: إغلاق مؤقت للفترة المحاسبية
- **F8**: إغلاق نهائي للفترة المحاسبية
- **F9**: إعادة فتح فترة مغلقة مؤقتاً
- **F10**: عرض تسويات الفترة المحاسبية
- **Ctrl+S**: حفظ التغييرات
- **Ctrl+Z**: إلغاء التغييرات
- **Ctrl+F**: البحث في الفترات المحاسبية
- **Ctrl+P**: طباعة بيانات الفترات المحاسبية
- **Alt+X**: العودة إلى شاشة السنوات المالية

### أزرار الشاشة السريعة
- **زر إنشاء سنة مالية جديدة**: إنشاء سنة مالية جديدة
- **زر تعديل**: تعديل بيانات السنة المالية المحددة
- **زر حذف**: حذف السنة المالية المحددة (إذا كانت غير مستخدمة)
- **زر تفعيل/تعطيل**: تغيير حالة السنة المالية
- **زر تعيين كافتراضية**: تعيين السنة المالية المحددة كافتراضية
- **زر عرض التفاصيل**: عرض تفاصيل السنة المالية المحددة
- **زر الفترات المحاسبية**: عرض وإدارة الفترات المحاسبية للسنة المالية
- **زر الإعدادات المتقدمة**: إدارة الإعدادات المتقدمة للسنة المالية
- **زر إنشاء فترات تلقائياً**: إنشاء فترات محاسبية تلقائياً
- **زر الإحصائيات**: عرض إحصائيات السنة المالية
- **زر الإقفال**: تنفيذ عملية إقفال السنة المالية
- **زر ترحيل الأرصدة**: ترحيل أرصدة السنة المالية
- **زر نسخ**: نسخ إعدادات سنة مالية لإنشاء سنة جديدة
- **زر تصدير**: تصدير بيانات السنوات المالية
- **زر استيراد**: استيراد بيانات سنوات مالية
- **زر الطباعة**: طباعة بيانات السنة المالية أو الفترات
- **زر المساعدة**: عرض معلومات المساعدة

### أزرار في شاشة الفترات المحاسبية
- **زر إضافة فترة**: إضافة فترة محاسبية جديدة
- **زر تعديل فترة**: تعديل بيانات الفترة المحاسبية المحددة
- **زر حذف فترة**: حذف الفترة المحاسبية المحددة (إذا كانت غير مستخدمة)
- **زر فتح الفترة**: فتح الفترة المحاسبية للسماح بإدخال القيود
- **زر إغلاق مؤقت**: إغلاق مؤقت للفترة المحاسبية
- **زر إغلاق نهائي**: إغلاق نهائي للفترة المحاسبية
- **زر إعادة فتح**: إعادة فتح فترة مغلقة مؤقتاً
- **زر التسويات**: إدارة تسويات الفترة المحاسبية
- **زر عرض القيود**: عرض القيود المحاسبية في الفترة
- **زر الإحصائيات**: عرض إحصائيات الفترة المحاسبية
- **زر الطباعة**: طباعة بيانات الفترة المحاسبية
- **زر العودة**: العودة إلى شاشة السنوات المالية

## ملاحظات تقنية إضافية

### اعتبارات تصميمية
- **النموذج المرن**: تم تصميم شاشة إعدادات السنة المالية لتدعم مختلف أنواع السنوات المالية والتقويمات
- **التصميم متعدد الطبقات**: استخدام نموذج الطبقات المتعددة لفصل واجهة المستخدم عن منطق الأعمال عن طبقة البيانات
- **تصميم العمليات**: تصميم العمليات لتكون آمنة ومتسقة خلال دورة حياة السنة المالية والفترات
- **قابلية التوسع**: تصميم الشاشة بطريقة مرنة تسمح بإضافة أنواع جديدة من الفترات أو إعدادات محاسبية
- **قابلية التخصيص**: إمكانية تخصيص الشاشة وسلوكها لتناسب احتياجات المؤسسات المختلفة
- **التكامل مع الوحدات الأخرى**: تصميم مدمج مع باقي وحدات النظام خاصة القيود المحاسبية والتقارير المالية

### تقنيات معالجة البيانات
- **التخزين المؤقت**: استخدام التخزين المؤقت لتحسين أداء عرض السنوات المالية والفترات المتكررة الاستخدام
- **معالجة الأحداث**: استخدام نمط الأحداث لإعلام الوحدات الأخرى بتغييرات السنة المالية والفترات
- **المعالجة المتزامنة**: دعم المعالجة المتزامنة للعمليات غير المتعارضة
- **وحدات العمل**: استخدام وحدات العمل (Transactions) لضمان اتساق البيانات خلال العمليات المعقدة
- **التاريخ الزمني**: الاحتفاظ بتاريخ زمني كامل للتغييرات على السنوات المالية والفترات

### اعتبارات أمنية
- **تصفية البيانات**: التصفية حسب صلاحيات المستخدم للسنوات المالية والفترات
- **سجل المراجعة**: تسجيل جميع التغييرات على السنوات المالية والفترات
- **فصل المهام**: تطبيق مبدأ فصل المهام في الصلاحيات المتعلقة بالسنة المالية
- **التأمين متعدد المستويات**: تأمين الفترات المغلقة من التعديل بمستويات مختلفة من الحماية
- **التحقق من الصلاحيات**: التحقق من صلاحيات المستخدم قبل أي عملية على السنة المالية أو الفترات

### متطلبات النظام
- **متطلبات قاعدة البيانات**: يوصى باستخدام قاعدة بيانات تدعم المعاملات وتتبع التغييرات
- **متطلبات الأداء**: يجب أن يكون النظام قادراً على التعامل مع عدة سنوات مالية وفترات متعددة
- **متطلبات الشبكة**: اتصال مستقر بالشبكة للوصول إلى بيانات السنوات المالية المشتركة
- **متطلبات التخزين**: مساحة تخزين كافية للاحتفاظ بسجلات السنوات المالية والفترات التاريخية

### توافق المتصفحات والأجهزة
- **توافق المتصفحات**: متوافقة مع جميع المتصفحات الحديثة
- **الأجهزة المحمولة**: واجهة مستخدم متجاوبة تعمل على مختلف أحجام الشاشات
- **الوصول عن بعد**: دعم الوصول الآمن عن بعد لإدارة السنوات المالية والفترات
- **الشاشات المتعددة**: دعم توزيع عناصر الشاشة على شاشات متعددة لسهولة العمل

### تكامل النظام
- **واجهات برمجة التطبيقات (APIs)**: توفير واجهات برمجة للتكامل مع أنظمة خارجية
- **تصدير/استيراد البيانات**: دعم تصدير واستيراد بيانات السنوات المالية بتنسيقات مختلفة
- **التكامل مع أنظمة التقارير**: الربط مع أنظمة التقارير لإنشاء تقارير مالية حسب الفترات
- **التكامل مع التقويمات الخارجية**: الربط مع أنظمة التقويم لمزامنة التواريخ والأحداث

### اعتبارات المحاسبة الدولية
- **دعم المعايير المحاسبية المختلفة**: تصميم يدعم معايير المحاسبة الدولية المختلفة (IFRS, GAAP)
- **التوافق مع المتطلبات الضريبية**: مراعاة المتطلبات الضريبية المختلفة للدول
- **تعدد العملات والتقويمات**: دعم العملات المتعددة والتقويمات المختلفة (ميلادي، هجري)
- **التقارير متعددة المعايير**: إمكانية إنشاء تقارير مالية وفق معايير محاسبية متعددة

### إدارة الأخطاء والتنبيهات
- **التحقق من الصحة**: التحقق من صحة البيانات قبل إجراء أي عملية على السنة المالية أو الفترات
- **رسائل الخطأ الواضحة**: عرض رسائل خطأ واضحة ومفيدة للمستخدم
- **نظام التنبيهات**: إرسال تنبيهات آلية حول أحداث مهمة مثل اقتراب نهاية الفترة
- **سجل الأخطاء**: الاحتفاظ بسجل تفصيلي للأخطاء لأغراض التتبع والتصحيح

### إدارة التحسينات المستقبلية
- **قابلية الترقية**: تصميم يسمح بترقية النظام دون تأثير على البيانات الموجودة
- **إضافة ميزات جديدة**: إمكانية إضافة أنواع جديدة من الفترات أو خوارزميات إقفال
- **توسعة الصلاحيات**: إمكانية إضافة مستويات جديدة من الصلاحيات والتحكم
- **دعم التعديلات التنظيمية**: القدرة على التكيف مع التغييرات في المتطلبات التنظيمية والمعايير المحاسبية

## أمثلة عملية

### مثال على إنشاء سنة مالية جديدة
1. النقر على زر "إنشاء سنة مالية جديدة"
2. إدخال رمز السنة المالية: "FY2023"
3. إدخال اسم السنة المالية: "السنة المالية 2023"
4. تحديد تاريخ البداية: "01/01/2023"
5. تحديد تاريخ النهاية: "31/12/2023"
6. اختيار نوع التقويم: "ميلادي"
7. اختيار نمط الفترات: "شهرية"
8. النقر على زر "إنشاء فترات تلقائياً"
9. مراجعة الفترات المنشأة تلقائياً (12 فترة شهرية)
10. النقر على زر "حفظ" لإنشاء السنة المالية مع فتراتها
11. يتم عرض رسالة تأكيد نجاح العملية

### مثال على إقفال فترة محاسبية
1. اختيار السنة المالية المطلوبة من القائمة
2. النقر على زر "الفترات المحاسبية" لعرض الفترات
3. تحديد الفترة المراد إقفالها
4. النقر على زر "إغلاق مؤقت"
5. تأكيد الإغلاق في نافذة التأكيد
6. النظام يقوم بفحص وجود قيود غير مرحلة في الفترة
7. النظام يقوم بفحص اكتمال جميع التسويات المطلوبة
8. في حالة نجاح الفحوصات، يتم إغلاق الفترة وتغيير حالتها
9. يتم عرض رسالة تأكيد نجاح العملية

### مثال على إقفال سنة مالية وترحيل الأرصدة
1. التأكد من إغلاق جميع الفترات المحاسبية في السنة المالية
2. النقر على زر "إقفال السنة المالية"
3. اختيار السنة المالية الهدف لترحيل الأرصدة إليها
4. تحديد خيارات الإقفال والترحيل (الحسابات المراد ترحيل أرصدتها)
5. النقر على زر "معاينة" لعرض تأثير عملية الإقفال والترحيل
6. مراجعة قيود الإقفال وقيود الأرصدة الافتتاحية المقترحة
7. النقر على زر "تنفيذ" لإجراء عملية الإقفال والترحيل
8. النظام يقوم بإنشاء قيود الإقفال في السنة المالية الحالية
9. النظام يقوم بإنشاء قيود الأرصدة الافتتاحية في السنة المالية الجديدة
10. تحديث حالة السنة المالية إلى "مغلقة"
11. يتم عرض تقرير بنتائج عملية الإقفال والترحيل