# شاشة صلاحيات الوصول (Access Permissions)

## نظرة عامة
شاشة صلاحيات الوصول هي واحدة من شاشات الإعدادات الأساسية في نظام الأونكس برو ERP، وتُستخدم لتكوين وإدارة صلاحيات الوصول للمستخدمين والمجموعات داخل النظام. تتيح هذه الشاشة للمسؤولين تحديد وتخصيص الصلاحيات التي تحكم وصول المستخدمين إلى الشاشات والتقارير والعمليات المختلفة، مما يضمن أن كل مستخدم يمكنه فقط الوصول إلى الموارد التي يحتاجها لأداء مهامه.

تُعتبر إدارة صلاحيات الوصول عنصراً محورياً في استراتيجية أمن المعلومات للنظام، حيث توفر طبقة حماية أساسية من خلال تطبيق مبدأ الحد الأدنى من الامتيازات وفصل المهام. من خلال هذه الشاشة، يمكن للمسؤولين إنشاء نموذج صلاحيات مرن ومتعدد المستويات، وتعيين أذونات تفصيلية على مستوى الوظائف والشاشات والحقول، وإدارة الوصول إلى البيانات حسب الفروع والأقسام، مما يعزز أمان النظام ويضمن الامتثال لسياسات وإرشادات الأمان المؤسسية.

## مكونات واجهة المستخدم

### القسم العلوي (شريط الأدوات)
- **شريط العنوان**: يعرض عنوان الشاشة "صلاحيات الوصول" مع أيقونة توضيحية
- **شريط الأدوات الرئيسي**: يحتوي على أزرار للوظائف الأساسية مثل:
  - زر حفظ التغييرات
  - زر إضافة صلاحية جديدة
  - زر حذف الصلاحية المحددة
  - زر تحديث البيانات
  - زر نسخ الصلاحيات
  - زر استيراد الصلاحيات
  - زر تصدير الصلاحيات
  - زر المساعدة
- **شريط البحث**: يتيح البحث السريع عن صلاحيات أو مستخدمين أو مجموعات
- **عوامل التصفية**: خيارات لتصفية عرض الصلاحيات حسب النوع أو المجموعة أو الحالة

### المنطقة اليمنى (هيكل الصلاحيات)
- **شجرة الوحدات والوظائف**: تعرض هيكل تنظيمي هرمي للنظام:
  - الوحدات الرئيسية (المحاسبة، المخزون، المبيعات، المشتريات، إلخ)
  - الوحدات الفرعية ضمن كل وحدة رئيسية
  - الشاشات والتقارير والعمليات ضمن كل وحدة
  - أيقونات تمييز لنوع الصلاحية (شاشة، تقرير، عملية)
  - مؤشرات لحالة الصلاحية (ممنوحة، ممنوعة، موروثة)
- **زر توسيع الكل**: لفتح جميع العناصر في الشجرة
- **زر طي الكل**: لطي جميع العناصر في الشجرة
- **شريط تمرير**: للتنقل في هيكل الصلاحيات

### المنطقة اليسرى (المستخدمون/المجموعات)
- **تبويبات التصنيف**:
  - تبويب المستخدمين: لعرض وتحديد المستخدمين
  - تبويب المجموعات: لعرض وتحديد مجموعات المستخدمين
  - تبويب الأدوار: لعرض وتحديد الأدوار الوظيفية
- **قائمة المستخدمين/المجموعات**:
  - اسم المستخدم/المجموعة/الدور
  - رمز التعريف
  - الحالة (نشط، معطل)
  - عدد الصلاحيات الممنوحة
  - أيقونات توضيحية للنوع
- **شريط أدوات**:
  - زر تحديد الكل
  - زر إلغاء التحديد
  - زر عكس التحديد
  - زر تصفية القائمة
- **شريط بحث**: للبحث ضمن القائمة المعروضة

### المنطقة الوسطى (تفاصيل الصلاحيات)
- **مصفوفة الصلاحيات**: تعرض تقاطع المستخدمين/المجموعات مع عناصر النظام:
  - صفوف تمثل المستخدمين أو المجموعات المحددة
  - أعمدة تمثل الوظائف المتاحة (عرض، تعديل، إضافة، حذف، طباعة)
  - خانات اختيار لتحديد مستوى الصلاحية
  - رموز ملونة توضح مصدر الصلاحية (مباشرة، موروثة، من دور)
- **منطقة تفاصيل العنصر المحدد**:
  - اسم ووصف العنصر المحدد من الشجرة
  - نوع العنصر (شاشة، تقرير، عملية، إلخ)
  - الوحدة التابع لها
  - الرمز التعريفي
- **تبويبات إضافية**:
  - تبويب الصلاحيات العامة
  - تبويب صلاحيات الحقول
  - تبويب صلاحيات البيانات
  - تبويب قيود الوصول

## الوظائف الرئيسية

### إدارة صلاحيات الوصول
1. **منح الصلاحيات للمستخدمين**:
   - تحديد المستخدم أو مجموعة المستخدمين المستهدفة
   - تحديد العنصر (شاشة، تقرير، عملية) من شجرة الوظائف
   - اختيار نوع الصلاحية المطلوبة (عرض، تعديل، إضافة، حذف، طباعة)
   - تحديد نطاق الصلاحية (عام، محدد بفرع، محدد بقسم)
   - تعيين فترة صلاحية الوصول (دائمة أو مؤقتة)
   - تطبيق الصلاحية وحفظ التغييرات

2. **سحب الصلاحيات**:
   - تحديد المستخدم أو المجموعة المراد سحب الصلاحية منها
   - تحديد العنصر المراد سحب الصلاحية له
   - إلغاء تحديد خانات الصلاحية المعنية
   - توثيق سبب سحب الصلاحية (اختياري)
   - تطبيق التغييرات على المستخدمين المتأثرين
   - حفظ التغييرات وتحديث قاعدة البيانات

3. **تعديل الصلاحيات**:
   - اختيار صلاحية موجودة للمراجعة
   - تغيير مستوى الصلاحية (من عرض إلى تعديل مثلاً)
   - تعديل نطاق الصلاحية وقيودها
   - تحديث فترة صلاحية الوصول
   - إضافة ملاحظات عن سبب التعديل
   - حفظ التغييرات وتحديث صلاحيات المستخدمين المتأثرين

4. **نسخ الصلاحيات**:
   - اختيار مستخدم أو مجموعة كمصدر للنسخ
   - تحديد المستخدمين أو المجموعات المستهدفة
   - تحديد نطاق الصلاحيات المراد نسخها (الكل، محدد)
   - اختيار خيارات النسخ (دمج أو استبدال)
   - معالجة حالات التعارض بين الصلاحيات
   - تنفيذ عملية النسخ وتطبيق التغييرات

5. **استيراد وتصدير الصلاحيات**:
   - تصدير صلاحيات محددة أو كاملة إلى ملف
   - تحديد تنسيق ملف التصدير (XML، CSV، JSON)
   - استيراد ملف صلاحيات من مصدر خارجي
   - مراجعة الصلاحيات المستوردة قبل تطبيقها
   - معالجة التعارضات والاختلافات بين البيانات
   - تطبيق الصلاحيات المستوردة على النظام

6. **تعريف نماذج الصلاحيات**:
   - إنشاء نماذج قياسية للصلاحيات حسب الأدوار الوظيفية
   - تحديد الصلاحيات الافتراضية لكل نموذج
   - تطبيق النماذج على مستخدمين أو مجموعات جدد
   - تحديث النماذج وتطبيق التغييرات على المستخدمين المرتبطين
   - تخصيص النماذج للحالات الخاصة
   - توثيق واعتماد نماذج الصلاحيات القياسية

### إدارة صلاحيات الحقول
1. **تحديد صلاحيات على مستوى الحقول**:
   - اختيار شاشة أو تقرير من الهيكل
   - عرض قائمة الحقول المتاحة في العنصر المحدد
   - تعيين مستوى الصلاحية لكل حقل (قراءة فقط، تعديل، إخفاء)
   - تطبيق صلاحيات مختلفة للحقول الحساسة
   - تحديد الحقول الإلزامية للمستخدم
   - حفظ إعدادات صلاحيات الحقول

2. **تصنيف وإدارة الحقول حسب الحساسية**:
   - تصنيف الحقول إلى مستويات حساسية مختلفة
   - تطبيق سياسات محددة لكل مستوى حساسية
   - إدارة حماية معلومات الهوية والبيانات الشخصية
   - تشفير أو إخفاء محتوى الحقول الحساسة للغاية
   - مراقبة الوصول إلى الحقول ذات الحساسية العالية
   - توثيق وتتبع التغييرات على إعدادات الحقول الحساسة

3. **إدارة تعارضات صلاحيات الحقول**:
   - تحديد وحل التعارضات بين الصلاحيات من مصادر مختلفة
   - تحديد أولوية المصادر المتعارضة (فردية، مجموعة، دور)
   - تطبيق قواعد دمج الصلاحيات من مصادر متعددة
   - مراجعة وتأكيد حل التعارضات
   - توفير تقارير عن تعارضات الصلاحيات
   - تطبيق سياسات موحدة لحل التعارضات

### إدارة صلاحيات البيانات
1. **تكوين فلاتر البيانات**:
   - إنشاء قواعد تصفية للبيانات حسب الوحدة التنظيمية
   - تحديد فلاتر البيانات حسب الفرع أو المنطقة
   - تقييد الوصول إلى بيانات معينة حسب المشروع
   - إنشاء فلاتر حسب العملاء أو المجموعات
   - تطبيق فلاتر متعددة المعايير للوصول للبيانات
   - تكوين استثناءات لفلاتر البيانات العامة

2. **إدارة صلاحيات الفروع**:
   - تحديد مستوى الوصول للمستخدم في كل فرع
   - منح أو تقييد الصلاحيات على مستوى الفروع
   - تكوين مصفوفة الصلاحيات متعددة الفروع
   - إدارة صلاحيات الفروع الرئيسية والفرعية
   - تحديد الفرع الافتراضي للمستخدم
   - تتبع استخدام الصلاحيات عبر الفروع المختلفة

3. **تكوين صلاحيات الوحدات التنظيمية**:
   - تحديد نطاق الوصول للبيانات حسب الهيكل التنظيمي
   - ربط المستخدمين بوحدات تنظيمية محددة
   - تكوين قواعد الوراثة في الهيكل التنظيمي
   - تطبيق تقييدات الوصول على مستوى القسم
   - إدارة صلاحيات الوحدات الرئيسية والفرعية
   - تحديث الصلاحيات تلقائياً عند تغيير الهيكل التنظيمي

4. **إدارة حدود مبالغ الصلاحيات**:
   - تحديد حدود مالية للموافقات والعمليات
   - إنشاء مستويات متدرجة للصلاحيات المالية
   - تكوين قواعد تصعيد الموافقات للمبالغ العالية
   - تحديد حدود مختلفة حسب نوع المعاملة
   - تطبيق حدود زمنية على الصلاحيات المالية
   - مراقبة ومراجعة استخدام الصلاحيات المالية

### إدارة الأمان المتقدم
1. **إدارة جلسات الوصول**:
   - تكوين قيود الجلسات حسب المستخدم أو المجموعة
   - تحديد فترات انتهاء الجلسات النشطة
   - مراقبة الجلسات المتعددة لنفس المستخدم
   - إنهاء الجلسات غير النشطة تلقائياً
   - تطبيق قيود الوصول المتزامن للحسابات الحساسة
   - تتبع وتسجيل نشاط الجلسات للمراجعة

2. **تكوين قيود الوصول الزمنية**:
   - تحديد ساعات الوصول المسموح بها للنظام
   - إنشاء جداول وصول مختلفة للمستخدمين والمجموعات
   - تطبيق قيود أيام الأسبوع للوصول
   - تكوين استثناءات لقيود الوقت العادية
   - منع الوصول خلال فترات الصيانة أو الإغلاق
   - إرسال تنبيهات عند محاولات الوصول خارج الأوقات المصرح بها

3. **تكوين قيود الوصول الجغرافية**:
   - تحديد مواقع وشبكات الوصول المسموح بها
   - تكوين قيود نطاقات عناوين IP
   - إنشاء قيود الوصول حسب الدولة أو المنطقة
   - تطبيق قيود الوصول على الأجهزة المحمولة
   - إدارة استثناءات القيود الجغرافية
   - تسجيل وتنبيه محاولات الوصول من مواقع غير مصرح بها

4. **تكامل المصادقة المتعددة العوامل**:
   - تكوين متطلبات المصادقة متعددة العوامل للوظائف الحساسة
   - تحديد عناصر النظام التي تتطلب مصادقة إضافية
   - تطبيق مستويات مختلفة من المصادقة حسب حساسية العملية
   - إدارة استثناءات المصادقة متعددة العوامل
   - تتبع وتسجيل استخدام المصادقة الإضافية
   - دمج قواعد المصادقة مع نظام الصلاحيات

## العمليات المتقدمة

### إدارة نماذج الصلاحيات المتقدمة
- **تصميم نماذج الصلاحيات متعددة المستويات**:
  - إنشاء هيكل هرمي للصلاحيات يعكس الهيكل التنظيمي
  - تصميم نماذج للأدوار الوظيفية القياسية
  - إنشاء علاقات وراثة بين مستويات الصلاحيات
  - دمج الصلاحيات من مصادر متعددة بناءً على قواعد محددة
  - تطبيق آليات لحل تعارضات الصلاحيات من مصادر مختلفة
  - توثيق وإدارة نماذج الصلاحيات عبر دورة حياتها

- **تطبيق نماذج الصلاحيات الذكية**:
  - تعريف قواعد تحليلية لتحديد الصلاحيات المناسبة
  - تطبيق الصلاحيات بناءً على سلوك المستخدم وأنماط الاستخدام
  - التعديل الديناميكي للصلاحيات استجابة للأحداث والظروف
  - تضييق أو توسيع نطاق الصلاحيات بناءً على تحليل المخاطر
  - تكييف الصلاحيات مع تغيرات بيئة العمل
  - قياس وتحسين فعالية نماذج الصلاحيات المطبقة

- **إدارة الصلاحيات الافتراضية**:
  - تعريف الصلاحيات الافتراضية للمستخدمين الجدد
  - إنشاء قوالب صلاحيات للأدوار الوظيفية المختلفة
  - تحديث الصلاحيات الافتراضية مركزياً
  - تكوين عملية اعتماد استثناءات الصلاحيات الافتراضية
  - مراجعة وتحسين الصلاحيات الافتراضية دورياً
  - توثيق أسباب ومبررات الصلاحيات الافتراضية

### الصلاحيات الديناميكية والشرطية
- **تكوين الصلاحيات المستندة إلى السياق**:
  - إنشاء قواعد للصلاحيات بناءً على سياق الوصول
  - تطبيق صلاحيات مختلفة حسب وقت اليوم أو اليوم من الأسبوع
  - تكييف الصلاحيات حسب موقع المستخدم أو الجهاز المستخدم
  - تغيير مستوى الصلاحيات بناءً على مستوى الأمان الحالي
  - تطبيق صلاحيات خاصة أثناء الطوارئ أو الصيانة
  - توثيق وتتبع تطبيق الصلاحيات السياقية

- **صلاحيات مستندة إلى العمليات**:
  - تحديد الصلاحيات المطلوبة لكل خطوة في سير العمل
  - منح صلاحيات مؤقتة مرتبطة بمهام محددة
  - سحب الصلاحيات تلقائياً عند اكتمال المهمة
  - ربط الصلاحيات بمراحل المشروع
  - تصعيد الصلاحيات بناءً على الظروف والمتطلبات
  - تتبع استخدام الصلاحيات المؤقتة وتوثيقها

- **الصلاحيات المستندة إلى الأحداث**:
  - تغيير الصلاحيات استجابةً لأحداث محددة في النظام
  - تفعيل صلاحيات الطوارئ عند اكتشاف تهديدات أمنية
  - تقييد الصلاحيات تلقائياً عند اكتشاف أنماط مشبوهة
  - توسيع الصلاحيات عند الحاجة لعمليات صيانة النظام
  - إدارة صلاحيات خاصة لفترات الإغلاق المالي
  - توثيق وتحليل تغييرات الصلاحيات المستندة إلى الأحداث

### التكامل مع أنظمة الأمان المتقدمة
- **التكامل مع أنظمة إدارة الهويات**:
  - مزامنة الصلاحيات مع نظام إدارة الهويات المركزي
  - تطبيق تسجيل دخول موحد مع إدارة الصلاحيات المتكاملة
  - استيراد بيانات المستخدمين والمجموعات من LDAP/Active Directory
  - مزامنة تغييرات الهيكل التنظيمي مع صلاحيات الوصول
  - تكامل عمليات إنشاء وتعديل وإلغاء الحسابات
  - تطبيق سياسات الصلاحيات عبر الأنظمة المختلفة

- **التكامل مع أنظمة كشف ومنع الاختراق**:
  - تقييد الصلاحيات تلقائياً عند اكتشاف محاولات اختراق
  - تبادل المعلومات مع أنظمة الأمان لتقييم المخاطر
  - تطبيق إجراءات وقائية استناداً إلى تحليل الأنماط
  - تعزيز مراقبة الصلاحيات ذات المخاطر العالية
  - توفير معلومات عن أنماط استخدام الصلاحيات
  - التفاعل مع نظام الاستجابة للحوادث الأمنية

- **تكامل الصلاحيات مع التشفير وإدارة المفاتيح**:
  - ربط صلاحيات الوصول للبيانات المشفرة بنظام إدارة المفاتيح
  - تطبيق التشفير التلقائي للبيانات الحساسة حسب الصلاحيات
  - إدارة صلاحيات فك التشفير لمستويات المستخدمين المختلفة
  - تكامل صلاحيات الوصول مع عمليات التوقيع الرقمي
  - تطبيق التشفير متعدد المستويات حسب الصلاحيات
  - توثيق وتتبع عمليات الوصول للبيانات المشفرة

### تحليلات وتدقيق الصلاحيات
- **لوحات متابعة استخدام الصلاحيات**:
  - عرض مؤشرات أداء رئيسية لاستخدام الصلاحيات
  - تحليل أنماط الوصول عبر الوقت
  - تتبع الاستخدام غير العادي للصلاحيات
  - مقارنة استخدام الصلاحيات بين الأقسام والمجموعات
  - قياس فعالية نماذج الصلاحيات المطبقة
  - توفير تقارير لدعم اتخاذ القرار

- **تحليل المخاطر المتقدم**:
  - تقييم مخاطر تكوين الصلاحيات الحالي
  - اكتشاف نقاط الضعف في هيكل الصلاحيات
  - تحليل تأثير تعارضات فصل المهام
  - مراجعة الصلاحيات المفرطة وتأثيرها على الأمان
  - تقييم فجوات الأمان في توزيع الصلاحيات
  - توصيات تحسين بناءً على تحليل المخاطر

- **المراجعة والتدقيق الشامل**:
  - تنفيذ مراجعات دورية لصلاحيات المستخدمين
  - توثيق وتحليل كل تغييرات الصلاحيات
  - تدقيق الامتثال لسياسات وإجراءات الصلاحيات
  - متابعة التوصيات من عمليات التدقيق السابقة
  - إنتاج تقارير للتدقيق الداخلي والخارجي
  - تحسين استراتيجية الصلاحيات بناءً على نتائج التدقيق

## مكونات طبقة التطبيق

### الكيانات (Entities)

#### Permission
كيان رئيسي يمثل الصلاحية الممنوحة ويحتوي على:
- معرف الصلاحية
- نوع الصلاحية (عرض، تعديل، إضافة، حذف، طباعة)
- العنصر المستهدف (شاشة، تقرير، عملية)
- معرف المستخدم أو المجموعة
- نوع المالك (مستخدم، مجموعة، دور)
- حالة الصلاحية (نشطة، معلقة، منتهية)
- تاريخ البدء
- تاريخ الانتهاء (اختياري)
- قيود النطاق (مثل الفرع، القسم)
- معلومات المنشئ والتاريخ
- معلومات آخر تعديل والتاريخ

#### PermissionGroup
كيان يمثل مجموعة من الصلاحيات المرتبطة معاً:
- معرف المجموعة
- اسم المجموعة
- وصف المجموعة
- قائمة الصلاحيات المضمنة
- حالة المجموعة
- تاريخ الإنشاء
- معلومات المنشئ
- معلومات آخر تعديل

#### PermissionRole
كيان يمثل دور وظيفي له مجموعة صلاحيات محددة:
- معرف الدور
- اسم الدور
- وصف الدور
- مستوى الدور
- قائمة الصلاحيات المرتبطة
- قائمة المستخدمين المرتبطين
- الدور الأعلى (للأدوار الهرمية)
- معلومات الإنشاء والتعديل

#### PermissionFieldLevel
كيان يمثل صلاحيات على مستوى الحقول:
- معرف صلاحية الحقل
- معرف الصلاحية الأساسية
- معرف العنصر (الشاشة أو التقرير)
- اسم الحقل
- نوع الصلاحية (قراءة، تعديل، إخفاء)
- معلومات الإنشاء والتعديل

#### PermissionDataFilter
كيان يمثل فلاتر البيانات المرتبطة بالصلاحيات:
- معرف الفلتر
- معرف الصلاحية
- نوع الفلتر (فرع، قسم، مشروع، إلخ)
- قيمة الفلتر
- تعبير الفلتر
- معلومات الإنشاء والتعديل

#### PermissionAudit
كيان يمثل سجل تدقيق تغييرات الصلاحيات:
- معرف سجل التدقيق
- معرف الصلاحية المتغيرة
- نوع العملية (إنشاء، تعديل، حذف)
- القيم القديمة
- القيم الجديدة
- المستخدم المنفذ
- تاريخ ووقت التغيير
- معلومات الجلسة

### الأوامر (Commands)

#### CreatePermissionCommand
إنشاء صلاحية جديدة في النظام.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم لإنشاء صلاحيات جديدة
- التحقق من وجود العنصر المستهدف في النظام
- التحقق من وجود المستخدم أو المجموعة المستهدفة
- التحقق من عدم وجود تعارض مع صلاحيات أخرى
- فحص صحة فترة الصلاحية (تاريخ البدء والانتهاء)
- التحقق من صحة قيود النطاق ومعايير التصفية
- إنشاء سجل تدقيق للعملية

#### UpdatePermissionCommand
تحديث صلاحية موجودة.

**منطق الأعمال والتحققات**:
- التحقق من وجود الصلاحية المراد تحديثها
- التحقق من صلاحية المستخدم لتعديل الصلاحيات
- التحقق من صحة البيانات المحدثة
- فحص تأثير التغييرات على المستخدمين المتأثرين
- التعامل مع تعارضات الصلاحيات المحتملة
- تحديث جميع الكيانات المرتبطة
- إنشاء سجل تدقيق للتغييرات

#### DeletePermissionCommand
حذف صلاحية موجودة.

**منطق الأعمال والتحققات**:
- التحقق من وجود الصلاحية المراد حذفها
- التحقق من صلاحية المستخدم لحذف الصلاحيات
- التحقق من عدم وجود كيانات أو صلاحيات أخرى تعتمد عليها
- إزالة جميع الارتباطات مع الكيانات الأخرى
- تحديث حالة المستخدمين المتأثرين
- إنشاء سجل تدقيق لعملية الحذف

#### CopyPermissionsCommand
نسخ صلاحيات من مستخدم أو مجموعة إلى آخرين.

**منطق الأعمال والتحققات**:
- التحقق من وجود المصدر والوجهات المستهدفة
- التحقق من صلاحية المستخدم لنسخ الصلاحيات
- تحديد الصلاحيات التي سيتم نسخها
- معالجة حالات التعارض أو التكرار
- تطبيق خيارات النسخ (استبدال أو دمج)
- إنشاء سجلات تدقيق لعمليات النسخ
- تحديث حالة المستخدمين المتأثرين

#### ImportPermissionsCommand
استيراد صلاحيات من ملف خارجي.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم لاستيراد الصلاحيات
- التحقق من صحة تنسيق ملف الاستيراد
- فحص مدى توافق البيانات المستوردة مع هيكل النظام
- معالجة حالات التعارض أو التكرار
- تطبيق خيارات الاستيراد (استبدال أو دمج)
- التحقق من وجود العناصر المستهدفة والمستخدمين
- إنشاء سجلات تدقيق لعملية الاستيراد

#### ExportPermissionsCommand
تصدير صلاحيات إلى ملف خارجي.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم لتصدير الصلاحيات
- تحديد نطاق الصلاحيات المراد تصديرها
- اختيار تنسيق التصدير المناسب
- معالجة البيانات الحساسة أثناء التصدير
- إنشاء سجل تدقيق لعملية التصدير

#### CreatePermissionRoleCommand
إنشاء دور وظيفي جديد مع صلاحيات محددة.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم لإنشاء أدوار
- التحقق من تفرد اسم الدور
- فحص صحة مجموعة الصلاحيات المرتبطة
- التحقق من الاتساق مع الهيكل التنظيمي
- التحقق من عدم وجود تعارض مع أدوار أخرى
- إنشاء سجل تدقيق للعملية

#### AssignPermissionRoleCommand
تعيين دور وظيفي لمستخدم أو مجموعة.

**منطق الأعمال والتحققات**:
- التحقق من وجود الدور والمستخدم أو المجموعة
- التحقق من صلاحية المستخدم لتعيين الأدوار
- فحص ملاءمة الدور للمستخدم أو المجموعة
- معالجة التعارضات مع الأدوار الحالية
- تحديث صلاحيات المستخدم أو المجموعة
- إنشاء سجل تدقيق للعملية

#### SetupFieldLevelPermissionsCommand
إعداد صلاحيات على مستوى الحقول.

**منطق الأعمال والتحققات**:
- التحقق من وجود الصلاحية الأساسية
- التحقق من صلاحية المستخدم لإدارة صلاحيات الحقول
- التحقق من وجود الحقول المستهدفة
- فحص اتساق نوع الصلاحية مع نوع الحقل
- التعامل مع الحقول الإلزامية والحساسة
- إنشاء سجل تدقيق للعملية

#### SetupDataFilterPermissionsCommand
إعداد فلاتر البيانات للصلاحيات.

**منطق الأعمال والتحققات**:
- التحقق من وجود الصلاحية الأساسية
- التحقق من صلاحية المستخدم لإدارة فلاتر البيانات
- التحقق من صحة معايير التصفية
- فحص تأثير الفلاتر على وصول المستخدمين
- التعامل مع تداخل الفلاتر وتعارضها
- إنشاء سجل تدقيق للعملية

### الاستعلامات (Queries)

#### GetPermissionByIdQuery
استرجاع صلاحية محددة بواسطة المعرف.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم للوصول إلى معلومات الصلاحيات
- البحث عن الصلاحية بالمعرف المحدد
- استرجاع كافة تفاصيل الصلاحية والكيانات المرتبطة
- تحديد مصدر الصلاحية (مباشرة، موروثة، من دور)
- فحص حالة الصلاحية وصلاحيتها

#### GetPermissionsByUserQuery
استرجاع جميع صلاحيات مستخدم محدد.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم للوصول إلى معلومات الصلاحيات
- استرجاع الصلاحيات المباشرة للمستخدم
- استرجاع الصلاحيات الموروثة من المجموعات
- استرجاع الصلاحيات المستمدة من الأدوار
- دمج الصلاحيات من المصادر المختلفة وحل التعارضات
- تصفية الصلاحيات النشطة فقط
- تنظيم الصلاحيات حسب النوع أو العنصر المستهدف

#### GetPermissionsByGroupQuery
استرجاع جميع صلاحيات مجموعة محددة.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم للوصول إلى معلومات الصلاحيات
- استرجاع الصلاحيات المباشرة للمجموعة
- استرجاع الصلاحيات الموروثة من المجموعات الأعلى
- دمج الصلاحيات من المصادر المختلفة
- تصفية الصلاحيات النشطة فقط
- تنظيم الصلاحيات حسب النوع أو العنصر المستهدف

#### GetPermissionsByRoleQuery
استرجاع جميع صلاحيات دور وظيفي محدد.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم للوصول إلى معلومات الأدوار
- استرجاع الصلاحيات المباشرة للدور
- استرجاع الصلاحيات الموروثة من الأدوار الأعلى
- دمج الصلاحيات من المصادر المختلفة
- تنظيم الصلاحيات حسب النوع أو العنصر المستهدف

#### GetPermissionsByTargetQuery
استرجاع جميع الصلاحيات لعنصر مستهدف محدد.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم للوصول إلى معلومات الصلاحيات
- استرجاع جميع الصلاحيات المرتبطة بالعنصر المحدد
- تصنيف الصلاحيات حسب المستخدمين والمجموعات والأدوار
- فلترة النتائج حسب نوع الصلاحية
- تحديد الصلاحيات النشطة والمنتهية

#### GetFieldLevelPermissionsQuery
استرجاع صلاحيات الحقول لصلاحية أساسية محددة.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم للوصول إلى معلومات صلاحيات الحقول
- استرجاع جميع صلاحيات الحقول المرتبطة بالصلاحية الأساسية
- تنظيم النتائج حسب الحقل أو نوع الصلاحية
- استرجاع معلومات الحقول وخصائصها

#### GetDataFilterPermissionsQuery
استرجاع فلاتر البيانات لصلاحية محددة.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم للوصول إلى معلومات فلاتر البيانات
- استرجاع جميع فلاتر البيانات المرتبطة بالصلاحية
- تنظيم النتائج حسب نوع الفلتر
- استرجاع معايير التصفية وتعبيراتها

#### GetPermissionsAuditQuery
استرجاع سجل تدقيق الصلاحيات.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم للوصول إلى سجلات التدقيق
- تصفية السجلات حسب الفترة الزمنية
- تصفية السجلات حسب نوع العملية
- تصفية السجلات حسب المستخدم المنفذ
- تصفية السجلات حسب الصلاحية المتأثرة
- تنظيم النتائج حسب التسلسل الزمني

#### CheckUserPermissionQuery
التحقق من امتلاك المستخدم لصلاحية محددة.

**منطق الأعمال والتحققات**:
- التحقق من وجود المستخدم
- البحث عن الصلاحية المحددة للمستخدم
- التحقق من الصلاحيات المباشرة والموروثة والمستمدة من الأدوار
- التحقق من حالة الصلاحية وصلاحيتها
- فحص قيود النطاق وفلاتر البيانات
- إرجاع نتيجة التحقق مع تفاصيل المصدر 

## اختصارات لوحة المفاتيح

| الاختصار | الوظيفة |
|-----------|---------|
| Ctrl+N | إنشاء صلاحية جديدة |
| Ctrl+S | حفظ التغييرات |
| Ctrl+D | حذف الصلاحية المحددة |
| Ctrl+F | البحث عن صلاحية أو مستخدم |
| Ctrl+R | تحديث البيانات |
| Ctrl+P | طباعة تقرير الصلاحيات |
| Ctrl+E | تصدير الصلاحيات |
| Ctrl+I | استيراد الصلاحيات |
| Ctrl+C | نسخ الصلاحيات المحددة |
| Ctrl+V | لصق الصلاحيات المنسوخة |
| F1 | عرض المساعدة |
| F5 | تحديث عرض الصلاحيات |
| Alt+U | التبديل إلى تبويب المستخدمين |
| Alt+G | التبديل إلى تبويب المجموعات |
| Alt+R | التبديل إلى تبويب الأدوار |
| Ctrl+Alt+F | التبديل إلى تبويب صلاحيات الحقول |
| Ctrl+Alt+D | التبديل إلى تبويب فلاتر البيانات |
| Alt+1 | توسيع جميع عناصر الشجرة |
| Alt+2 | طي جميع عناصر الشجرة |
| Ctrl+Alt+A | تطبيق الصلاحيات على المستخدمين المحددين |
| Ctrl+Alt+S | عرض تاريخ الصلاحية المحددة |
| F3 | البحث التالي |
| Shift+F3 | البحث السابق |
| Esc | إلغاء العملية الحالية | 