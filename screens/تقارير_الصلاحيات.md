# شاشة تقارير الصلاحيات (Permissions Reports)

## نظرة عامة
شاشة تقارير الصلاحيات هي واحدة من شاشات الإعدادات الأساسية في نظام الأونكس برو ERP، وتُستخدم لإنشاء وعرض وإدارة التقارير المتعلقة بصلاحيات المستخدمين والمجموعات في النظام. تتيح هذه الشاشة للمسؤولين مراقبة وتحليل توزيع الصلاحيات، واكتشاف التعارضات، وتتبع التغييرات، وضمان الامتثال لسياسات الأمان المؤسسية.

تُعتبر تقارير الصلاحيات أداة حيوية للتدقيق والمراجعة، حيث توفر رؤية شاملة عن كيفية توزيع وإدارة الصلاحيات في النظام. من خلال هذه الشاشة، يمكن للمسؤولين تحليل أنماط استخدام الصلاحيات، ومراقبة التغييرات، وتحديد المخاطر المحتملة، وتوثيق الامتثال للمعايير والسياسات الأمنية.

## مكونات واجهة المستخدم

### القسم العلوي (شريط الأدوات)
- **شريط العنوان**: يعرض عنوان الشاشة "تقارير الصلاحيات" مع أيقونة توضيحية
- **شريط الأدوات الرئيسي**: يحتوي على أزرار للوظائف الأساسية مثل:
  - زر إنشاء تقرير جديد (أيقونة +)
  - زر تشغيل التقرير المحدد (أيقونة تشغيل)
  - زر حفظ التقرير (أيقونة حفظ)
  - زر تصدير التقرير (أيقونة تصدير)
  - زر طباعة التقرير (أيقونة طابعة)
  - زر جدولة تشغيل التقرير (أيقونة تقويم)
  - زر مشاركة التقرير (أيقونة مشاركة)
  - زر المساعدة (أيقونة علامة استفهام)
- **شريط البحث**: يتيح البحث السريع عن تقارير محددة حسب الاسم أو الوصف
- **عوامل التصفية**: خيارات لتصفية قائمة التقارير (الكل، المفضلة، الأخيرة، المشتركة)
- **مؤشر الحالة**: رموز ملونة توضح حالة التقارير (محفوظة، مؤقتة، مجدولة، خطأ)

### القسم الأيسر (قائمة التقارير)
- **قائمة التقارير المعرفة مسبقاً**:
  - تقرير صلاحيات المستخدمين
  - تقرير صلاحيات المجموعات
  - تقرير الصلاحيات حسب الشاشة/الوظيفة
  - تقرير تعارض الصلاحيات
  - تقرير تغييرات الصلاحيات
  - تقرير الصلاحيات الحرجة
  - تقرير متابعة استخدام الصلاحيات
  - تقرير استثناءات الصلاحيات
  - تقرير صلاحيات الوصول للبيانات
  - تقرير صلاحيات التقارير

- **قائمة التقارير المخصصة**: تعرض التقارير التي قام المستخدم بإنشائها أو تخصيصها
- **شريط التمرير**: للتنقل في قائمة التقارير
- **زر المجلدات**: لتنظيم التقارير في مجلدات للوصول السريع
- **خيارات الفرز**: لترتيب التقارير حسب الاسم، تاريخ الإنشاء، تاريخ آخر تشغيل

### القسم الأيمن (منطقة إعداد وعرض التقرير)
تنقسم منطقة التقرير إلى عدة تبويبات:

#### تبويب معايير التقرير
- **مجموعة اختيار نوع التقرير**:
  - قائمة منسدلة لاختيار نوع التقرير
  - وصف مختصر للتقرير المختار
  - إعدادات خاصة بنوع التقرير
  
- **مجموعة معايير التصفية**:
  - تصفية حسب المستخدمين (اختيار فردي أو متعدد)
  - تصفية حسب مجموعات المستخدمين
  - تصفية حسب الشاشات والوظائف
  - تصفية حسب نوع الصلاحية
  - تصفية حسب الفترة الزمنية
  - تصفية حسب حالة الصلاحية (ممنوحة، ممنوعة، موروثة)
  - تصفية حسب مصدر الصلاحية (مباشرة، من خلال مجموعة، موروثة)
  
- **مجموعة خيارات العرض**:
  - نمط عرض التقرير (جدول، شجرة، مصفوفة، رسم بياني)
  - خيارات تجميع البيانات
  - خيارات الفرز والترتيب
  - خيارات التلوين والتنسيق الشرطي
  - عدد السجلات في الصفحة الواحدة
  - إظهار/إخفاء الأعمدة المختلفة

#### تبويب نتائج التقرير
- **شريط أدوات النتائج**:
  - أزرار للتصدير بتنسيقات مختلفة (PDF، Excel، CSV)
  - زر الطباعة
  - زر التحديث
  - زر تكبير/تصغير
  - أزرار التنقل بين الصفحات
  
- **منطقة عرض النتائج**:
  - جدول البيانات مع إمكانية التصفية والفرز
  - عرض تفصيلي للصلاحيات حسب المعايير المحددة
  - خيارات للتوسيع والطي للعناصر المتداخلة
  - تلوين شرطي لتسهيل قراءة النتائج
  
- **شريط المعلومات السفلي**:
  - إجمالي عدد السجلات
  - معلومات عن وقت تنفيذ التقرير
  - معلومات عن حالة التقرير

#### تبويب الرسوم البيانية
- **شريط أدوات الرسوم البيانية**:
  - اختيار نوع الرسم البياني (دائري، أعمدة، خطي، فقاعي)
  - خيارات التكبير والتصغير
  - خيارات الألوان والتنسيق
  - خيارات العرض ثلاثي الأبعاد
  
- **منطقة عرض الرسوم البيانية**:
  - عرض مرئي لتوزيع الصلاحيات
  - رسوم تفاعلية مع إمكانية التحويل بين الأنواع
  - رسوم متعددة لمقارنة البيانات المختلفة
  - تسميات توضيحية وشروح
  
- **منطقة التحليل**:
  - ملخص للنقاط الرئيسية في البيانات
  - مؤشرات الأداء والامتثال
  - تحليل الاتجاهات إذا تم اختيار بيانات تاريخية

#### تبويب جدولة التقرير
- **إعدادات الجدولة**:
  - اختيار التكرار (يومي، أسبوعي، شهري، مخصص)
  - تحديد الوقت والتاريخ
  - تحديد فترة التنفيذ (البداية والنهاية)
  - خيارات الإشعارات
  
- **خيارات التوزيع**:
  - إضافة مستلمي التقارير
  - تحديد طريقة الإرسال (بريد إلكتروني، رسائل نظام)
  - تنسيق التقرير المرسل (PDF، Excel، رابط)
  - إضافة نص توضيحي للتقرير المرسل
  
- **سجل التنفيذ**:
  - عرض تاريخ تنفيذ التقرير المجدول
  - حالة التنفيذ (نجاح، فشل، معلق)
  - روابط للتقارير السابقة

## الوظائف الرئيسية

### إنشاء وإدارة التقارير
1. **إنشاء تقرير جديد**:
   - اختيار نوع التقرير من القائمة المتاحة
   - تحديد معايير التصفية والعرض
   - تخصيص حقول ومحتوى التقرير
   - حفظ التقرير بمعايير مخصصة للاستخدام المستقبلي
   - إعطاء اسم ووصف للتقرير الجديد

2. **تشغيل التقارير**:
   - تشغيل التقارير المعرفة مسبقاً
   - تشغيل التقارير المخصصة
   - ضبط معايير التصفية قبل التشغيل
   - عرض النتائج في صيغ مختلفة (جدول، رسم بياني)
   - حفظ نتائج التقرير للمراجعة لاحقاً

3. **تخصيص التقارير**:
   - تعديل تصميم التقارير الموجودة
   - إضافة أو إزالة حقول من التقرير
   - تغيير طريقة عرض البيانات
   - تخصيص المرشحات وشروط الفرز
   - تخصيص تنسيق وألوان التقرير

4. **تصدير ومشاركة التقارير**:
   - تصدير التقارير بصيغ متعددة (PDF، Excel، CSV، HTML)
   - طباعة التقارير مباشرة
   - مشاركة التقارير مع مستخدمين آخرين
   - إرسال التقارير بالبريد الإلكتروني
   - حفظ التقارير في موقع مشترك

5. **جدولة التقارير**:
   - إعداد جدولة دورية لتنفيذ التقارير
   - تحديد توقيت ووتيرة التنفيذ
   - تكوين قائمة المستلمين للتقارير المجدولة
   - ضبط تنسيق ومحتوى البريد الإلكتروني
   - مراقبة حالة التقارير المجدولة وتنفيذها

### تقارير صلاحيات المستخدمين
1. **تقرير صلاحيات المستخدم**:
   - عرض كافة صلاحيات مستخدم محدد
   - تصنيف الصلاحيات حسب النوع (شاشات، تقارير، مستندات)
   - تمييز مصدر الصلاحية (مباشرة، موروثة من مجموعة)
   - إظهار حالة الصلاحية (ممنوحة، ممنوعة، معلقة)
   - إمكانية مقارنة صلاحيات عدة مستخدمين

2. **تقرير تغييرات صلاحيات المستخدم**:
   - تتبع تاريخ التغييرات على صلاحيات المستخدم
   - عرض من قام بالتغيير ومتى
   - تمييز الصلاحيات المضافة والملغاة
   - تحليل أنماط التغيير مع مرور الوقت
   - تصفية حسب فترة زمنية محددة

3. **تقرير مقارنة المستخدمين**:
   - مقارنة صلاحيات عدة مستخدمين جنباً إلى جنب
   - تحديد الاختلافات في الصلاحيات بين المستخدمين
   - مساعدة في توحيد صلاحيات المستخدمين ذوي الأدوار المتشابهة
   - تسهيل نقل المهام بين المستخدمين
   - اكتشاف أوجه عدم الاتساق في توزيع الصلاحيات

### تقارير صلاحيات المجموعات
1. **تقرير صلاحيات المجموعة**:
   - عرض كافة صلاحيات مجموعة مستخدمين محددة
   - تصنيف الصلاحيات حسب النوع
   - عرض المستخدمين الأعضاء في المجموعة
   - إظهار الصلاحيات الممنوحة والممنوعة للمجموعة
   - تحليل مستوى الصلاحيات حسب الدور الوظيفي

2. **تقرير تغييرات صلاحيات المجموعات**:
   - تتبع تاريخ التغييرات على صلاحيات المجموعات
   - تحليل تأثير التغييرات على المستخدمين الأعضاء
   - تمييز المستخدمين المتأثرين بالتغييرات
   - عرض من قام بالتغيير ومتى
   - مؤشرات لمدى تأثير التغيير

3. **تقرير مقارنة المجموعات**:
   - مقارنة صلاحيات عدة مجموعات جنباً إلى جنب
   - تحليل درجة التداخل والاختلاف بين المجموعات
   - المساعدة في إعادة هيكلة المجموعات
   - تحسين توزيع الصلاحيات وتفادي التكرار
   - تحديد فرص تبسيط هيكل الصلاحيات

### تقارير الصلاحيات حسب الشاشة/الوظيفة
1. **تقرير صلاحيات الشاشة**:
   - عرض المستخدمين والمجموعات التي تملك صلاحيات على شاشة محددة
   - تصنيف المستخدمين حسب مستوى الصلاحية (عرض، تعديل، إنشاء، حذف)
   - تحليل توزيع الصلاحيات على مستوى الشاشات
   - اكتشاف الشاشات ذات التوزيع الواسع أو المحدود للصلاحيات
   - تحديد الشاشات الحساسة وتوزيع صلاحياتها

2. **تقرير صلاحيات الوظائف**:
   - عرض المستخدمين والمجموعات التي تملك صلاحيات على وظائف معينة
   - تصنيف حسب وظائف الأعمال (المحاسبة، المخزون، المشتريات، المبيعات)
   - تحليل التوازن في توزيع صلاحيات الوظائف بين الإدارات
   - اكتشاف الثغرات في تغطية الصلاحيات للوظائف الهامة
   - تقييم مدى التوافق مع متطلبات الفصل بين المهام

3. **تقرير الشاشات والوظائف غير المستخدمة**:
   - تحديد الشاشات والوظائف التي لم يتم منح صلاحيات عليها
   - اكتشاف المكونات غير المستخدمة في النظام
   - المساعدة في تنظيف وتبسيط هيكل الصلاحيات
   - تحديد فرص تدريب المستخدمين على الوظائف غير المستخدمة
   - تقديم توصيات لتحسين الاستفادة من إمكانيات النظام

### تقارير التدقيق والمراجعة
1. **تقرير تعارض الصلاحيات**:
   - اكتشاف تعارضات الصلاحيات المحتملة بين الوظائف
   - تحديد المستخدمين الذين يملكون صلاحيات متعارضة
   - تصنيف التعارضات حسب درجة الخطورة
   - عرض تفاصيل وأسباب التعارض
   - توصيات لمعالجة التعارضات المكتشفة

2. **تقرير الصلاحيات الحرجة**:
   - متابعة الصلاحيات ذات الحساسية العالية
   - تحديد المستخدمين الذين يملكون صلاحيات حرجة
   - مقارنة توزيع الصلاحيات الحرجة مع سياسات الأمان
   - تحليل مستوى المخاطر بناءً على توزيع الصلاحيات الحرجة
   - اقتراحات لتحسين ضوابط الصلاحيات الحرجة

3. **تقرير الامتثال والحوكمة**:
   - تقييم مدى التوافق مع سياسات الأمان والحوكمة
   - قياس الامتثال للمعايير والضوابط الرقابية
   - متابعة مؤشرات الامتثال عبر الوقت
   - تحديد مجالات عدم الامتثال وفرص التحسين
   - توفير دليل للتدقيق الداخلي والخارجي

### تقارير تحليلية متقدمة
1. **تقرير تحليل أنماط الصلاحيات**:
   - تحليل أنماط منح الصلاحيات عبر المؤسسة
   - اكتشاف العلاقات والارتباطات بين الصلاحيات المختلفة
   - تحديد الصلاحيات الأكثر واألقل استخداماً
   - اقتراح نماذج تحسين لهيكل الصلاحيات
   - تبسيط وترشيد توزيع الصلاحيات

2. **تقرير متابعة استخدام الصلاحيات**:
   - تحليل مدى استخدام الصلاحيات الممنوحة
   - تحديد الصلاحيات غير المستخدمة لفترات طويلة
   - ربط استخدام الصلاحيات بمؤشرات الأداء
   - اكتشاف التغيرات في أنماط الاستخدام
   - اقتراحات لإعادة توزيع أو سحب الصلاحيات غير المستخدمة

3. **تقرير فعالية توزيع الصلاحيات**:
   - تقييم مدى فعالية هيكل الصلاحيات الحالي
   - مقارنة النموذج الحالي مع نماذج مثالية
   - قياس مؤشرات أداء نظام الصلاحيات
   - تحديد فرص تحسين كفاءة وفعالية توزيع الصلاحيات
   - اقتراح استراتيجيات لتطوير إدارة الصلاحيات

## العمليات المتقدمة

### التكامل مع نظام الصلاحيات
- **استقطاب البيانات من نظام الصلاحيات**:
  - آلية قراءة وتحليل بيانات الصلاحيات من قاعدة البيانات
  - التزامن المباشر مع تغييرات الصلاحيات
  - معالجة العلاقات المعقدة بين المستخدمين والمجموعات والصلاحيات
  - استقطاب بيانات سجل التدقيق والتغييرات
  - التكامل مع سياسات الأمان المؤسسية

- **تحليل مصفوفة الصلاحيات**:
  - بناء وتحليل مصفوفة الصلاحيات الكاملة للنظام
  - اكتشاف أنماط وعلاقات معقدة في توزيع الصلاحيات
  - تحليل التداخل والترابط بين مجموعات الصلاحيات
  - تحديد المستخدمين ذوي الصلاحيات الاستثنائية
  - تقييم توازن توزيع الصلاحيات عبر المؤسسة

- **مراقبة التغييرات الحية**:
  - تتبع التغييرات في الصلاحيات في الوقت الفعلي
  - إنشاء تنبيهات للتغييرات الحساسة أو غير المصرح بها
  - تسجيل سلسلة كاملة من التغييرات لأغراض المراجعة
  - تحليل أنماط التغيير عبر الزمن
  - ربط التغييرات بالمستخدمين والأحداث في النظام

### التحليل المتقدم للصلاحيات
- **خوارزميات كشف التعارض**:
  - تطبيق خوارزميات متقدمة لاكتشاف تعارضات الصلاحيات
  - تحليل العلاقات المعقدة بين الصلاحيات للكشف عن التعارضات غير المباشرة
  - تصنيف التعارضات حسب درجة الخطورة والأولوية
  - تقديم اقتراحات محددة لمعالجة كل تعارض
  - تحديث قواعد التعارض بناءً على تغيرات بيئة العمل

- **تحليل المخاطر الأمنية**:
  - تطبيق نماذج تقييم المخاطر على توزيع الصلاحيات
  - تحديد نقاط الضعف المحتملة في هيكل الصلاحيات
  - تقييم تأثير الصلاحيات على المخاطر الكلية للنظام
  - اقتراح تدابير للتخفيف من المخاطر المكتشفة
  - مراقبة مؤشرات المخاطر عبر الزمن

- **التعلم الآلي وتحليل الأنماط**:
  - استخدام تقنيات التعلم الآلي لاكتشاف أنماط غير طبيعية
  - تحديد الانحرافات عن أنماط الاستخدام العادية
  - التنبؤ بالمخاطر المحتملة بناءً على التحليل السلوكي
  - تحسين قواعد اكتشاف التعارض بشكل مستمر
  - اقتراح توزيع الصلاحيات الأمثل بناءً على الأنماط المكتشفة

### الإبلاغ والمراقبة المتقدمة
- **لوحات المتابعة التفاعلية**:
  - عرض مؤشرات ومقاييس الصلاحيات في لوحات متابعة حية
  - تكوين لوحات متابعة مخصصة حسب الأدوار المختلفة
  - إمكانية التفاعل المباشر مع البيانات والتحليلات
  - عرض الاتجاهات والتغيرات عبر الزمن
  - تنبيهات مرئية للمشكلات والتعارضات

- **التنبيهات والإشعارات**:
  - إعداد قواعد تنبيه لمختلف أنواع المشكلات والمخاطر
  - إرسال إشعارات فورية عند اكتشاف تعارضات أو مخاطر
  - تخصيص قنوات الإشعار (بريد إلكتروني، تنبيهات داخل النظام، رسائل)
  - جدولة تقارير دورية للمراجعة والمتابعة
  - توثيق التنبيهات والاستجابات لأغراض المراجعة

- **تقارير الامتثال المتقدمة**:
  - إعداد تقارير متخصصة للامتثال للمعايير المختلفة
  - توثيق التوافق مع متطلبات الحوكمة والرقابة
  - توفير سجل شامل للتغييرات واملراجعات
  - إنتاج أدلة وشواهد للمراجعين الداخليين والخارجيين
  - تتبع مؤشرات الامتثال عبر الزمن

### التكامل مع الأنظمة الأخرى
- **التكامل مع نظام إدارة الهوية**:
  - ربط تقارير الصلاحيات مع نظام إدارة هوية المستخدمين
  - تحليل العلاقة بين الهيكل التنظيمي وتوزيع الصلاحيات
  - التحقق من توافق الصلاحيات مع الأدوار الوظيفية
  - تتبع التغييرات في المناصب والأدوار وتأثيرها على الصلاحيات
  - توفير آلية للتحديث التلقائي للصلاحيات عند تغيير المناصب

- **التكامل مع نظام إدارة المخاطر**:
  - تبادل البيانات مع نظام إدارة المخاطر المؤسسية
  - ربط مخاطر الصلاحيات بسجل المخاطر الشامل
  - تقييم تأثير التغييرات في الصلاحيات على ملف المخاطر
  - توفير مؤشرات أداء موحدة للمخاطر المتعلقة بالصلاحيات
  - التكامل مع استراتيجية إدارة المخاطر المؤسسية

- **التكامل مع أنظمة التدقيق والرقابة**:
  - توفير واجهات برمجية لأنظمة التدقيق الخارجية
  - تبادل البيانات مع أنظمة مراقبة الامتثال
  - توفير سجلات ومستندات للمراجعة الخارجية
  - دعم معايير وأطر الرقابة الداخلية
  - تكامل مع أنظمة إدارة الجودة وضمان الامتثال

## الارتباط مع الشاشات الأخرى

### الارتباط مع شاشة إدارة المستخدمين
- **عرض تقارير صلاحيات المستخدم**: إمكانية عرض تقارير تفصيلية عن صلاحيات المستخدم المحدد
- **تحليل تأثير التغييرات**: تقييم تأثير تغيير معلومات المستخدم على الصلاحيات
- **اقتراحات الصلاحيات**: تقديم اقتراحات لصلاحيات المستخدم بناءً على تحليل الأنماط
- **التحقق من التعارضات**: فحص تعارضات الصلاحيات عند تعديل صلاحيات المستخدم
- **متابعة تاريخ الصلاحيات**: عرض تاريخ كامل لتغييرات صلاحيات المستخدم

### الارتباط مع شاشة مجموعات المستخدمين
- **تحليل صلاحيات المجموعة**: عرض تقارير شاملة عن صلاحيات المجموعة
- **تقييم التأثير على المستخدمين**: تحليل تأثير تغيير صلاحيات المجموعة على المستخدمين
- **اقتراح تحسينات للمجموعات**: تقديم اقتراحات لتحسين توزيع الصلاحيات بين المجموعات
- **مقارنة المجموعات**: توفير أدوات لمقارنة صلاحيات المجموعات المختلفة
- **تحليل العضوية**: تقارير عن توزيع المستخدمين على المجموعات وتداخل العضوية

### الارتباط مع شاشة صلاحيات الوصول
- **تحليل أنماط الوصول**: عرض تقارير عن أنماط صلاحيات الوصول للبيانات
- **تقييم مستويات الوصول**: تحليل مستويات الوصول المختلفة عبر النظام
- **متابعة تغييرات الوصول**: تتبع التغييرات في صلاحيات الوصول عبر الزمن
- **تقارير الامتثال للوصول**: تقييم توافق صلاحيات الوصول مع سياسات الأمان
- **اكتشاف استثناءات الوصول**: تحديد الاستثناءات غير العادية في صلاحيات الوصول

### الارتباط مع شاشة صلاحيات الشاشات
- **تحليل توزيع صلاحيات الشاشات**: تقارير عن توزيع الوصول للشاشات المختلفة
- **تقييم استخدام الشاشات**: تحليل مدى استخدام الشاشات وصلاحياتها
- **متابعة تغييرات صلاحيات الشاشات**: تتبع التغييرات في صلاحيات الشاشات
- **تحليل التكامل بين الشاشات**: دراسة العلاقات والتداخل بين صلاحيات الشاشات المختلفة
- **تقارير الصلاحيات الحرجة**: تحديد الشاشات ذات الصلاحيات الحساسة ومراقبتها

### الارتباط مع شاشة صلاحيات المستندات
- **تحليل صلاحيات المستندات**: تقارير عن توزيع صلاحيات المستندات
- **تقييم دورة حياة المستندات**: تحليل الصلاحيات خلال مراحل دورة حياة المستندات
- **متابعة تغييرات صلاحيات المستندات**: تتبع التغييرات في صلاحيات المستندات
- **تحليل التدفق والاعتماد**: دراسة تدفق المستندات وعلاقته بالصلاحيات
- **تقارير الفصل بين المهام**: التحقق من الفصل المناسب بين المهام في صلاحيات المستندات

### الارتباط مع شاشة سجل الدخول
- **تحليل العلاقة بين الصلاحيات والدخول**: ربط أنماط الدخول بصلاحيات المستخدمين
- **تقييم استخدام الصلاحيات**: تحليل استخدام الصلاحيات الفعلي مقارنة بالصلاحيات الممنوحة
- **اكتشاف الأنماط غير العادية**: تحديد الانحرافات في استخدام الصلاحيات
- **تتبع محاولات الوصول غير المصرح**: تحليل محاولات الوصول غير المصرح بها
- **تقارير النشاط**: توفير تقارير مفصلة عن نشاط المستخدمين وعلاقته بالصلاحيات

### الارتباط مع شاشة متابعة عمليات المستخدمين
- **تحليل استخدام الصلاحيات**: ربط العمليات المنفذة بالصلاحيات المستخدمة
- **تقييم فعالية الصلاحيات**: تحليل مدى ملاءمة الصلاحيات للعمليات الفعلية
- **اكتشاف سوء استخدام الصلاحيات**: تحديد حالات الاستخدام غير المناسب للصلاحيات
- **تتبع العمليات الحساسة**: مراقبة العمليات التي تتطلب صلاحيات حساسة
- **تقارير النشاط والصلاحيات**: توفير رؤية متكاملة للعلاقة بين النشاط والصلاحيات

## مكونات طبقة التطبيق

### الكيانات (Entities)

#### PermissionReport (تقرير الصلاحيات)
كيان رئيسي يمثل تقرير صلاحيات مخصص:
- رقم التعريف (ID)
- اسم التقرير (Name)
- وصف التقرير (Description)
- نوع التقرير (ReportType)
- معايير التقرير (Criteria) - مخزنة كـ JSON
- إعدادات العرض (DisplaySettings) - مخزنة كـ JSON
- حالة التقرير (Status)
- المستخدم المنشئ (CreatedBy)
- تاريخ الإنشاء (CreatedOn)
- المستخدم المعدل (ModifiedBy)
- تاريخ التعديل (ModifiedOn)
- تاريخ آخر تشغيل (LastRunOn)
- وقت التنفيذ (ExecutionTime)
- عدد السجلات (RecordCount)
- التصنيف (Category)
- علامات (Tags)
- رقم النسخة (VersionNumber)

#### ReportSchedule (جدولة التقرير)
كيان يمثل جدولة تنفيذ تقرير:
- رقم التعريف (ID)
- رقم تقرير الصلاحيات (PermissionReportId)
- نوع التكرار (RecurrenceType)
- تفاصيل التكرار (RecurrenceDetails) - مخزنة كـ JSON
- تاريخ البداية (StartDate)
- تاريخ الانتهاء (EndDate)
- حالة الجدولة (Status)
- آخر تنفيذ (LastExecutionTime)
- التنفيذ القادم (NextExecutionTime)
- المستخدم المنشئ (CreatedBy)
- تاريخ الإنشاء (CreationDate)
- إعدادات الإشعارات (NotificationSettings)

#### ReportSubscription (اشتراك التقرير)
كيان يمثل اشتراك مستخدم في تقرير محدد:
- رقم التعريف (ID)
- رقم تقرير الصلاحيات (PermissionReportId)
- رقم المستخدم (UserId)
- نوع الاشتراك (SubscriptionType)
- طريقة التوصيل (DeliveryMethod)
- تنسيق التقرير (ReportFormat)
- رقم جدولة التقرير (ScheduleId) - اختياري
- حالة الاشتراك (Status)
- تاريخ الاشتراك (SubscriptionDate)
- ملاحظات (Notes)

#### ReportExecution (تنفيذ التقرير)
كيان يمثل سجل تنفيذ تقرير:
- رقم التعريف (ID)
- رقم تقرير الصلاحيات (PermissionReportId)
- تاريخ التنفيذ (ExecutionTime)
- المستخدم المنفذ (ExecutedBy)
- وقت التنفيذ المستغرق (Duration)
- حالة التنفيذ (Status)
- رسالة الحالة (StatusMessage)
- عدد السجلات (RecordCount)
- معايير التنفيذ (ExecutionCriteria)
- رقم الجدولة (ScheduleId) - اختياري
- مسار ملف النتائج (ResultFilePath) - اختياري

#### ReportResult (نتيجة التقرير)
كيان يمثل نتائج تقرير تم تنفيذه:
- رقم التعريف (ID)
- رقم تنفيذ التقرير (ReportExecutionId)
- نتائج التقرير (Results) - مخزنة كـ JSON/XML
- ملخص النتائج (Summary) - مخزنة كـ JSON
- حجم النتائج (ResultSize)
- تاريخ إنشاء النتائج (CreationDate)
- تاريخ انتهاء الصلاحية (ExpiryDate)
- حالة النتائج (Status)

### الأوامر (Commands)

#### CreatePermissionReportCommand (أمر إنشاء تقرير صلاحيات)
إنشاء تقرير صلاحيات جديد في النظام.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم لإنشاء تقارير
- التحقق من صحة نوع التقرير
- التحقق من معايير التقرير وإعدادات العرض
- إنشاء سجل تقرير جديد
- تسجيل معلومات الإنشاء
- تخصيص رقم نسخة للتقرير الجديد
- إعادة رقم التقرير المنشأ

#### RunPermissionReportCommand (أمر تشغيل تقرير صلاحيات)
تنفيذ تقرير صلاحيات محدد مع معايير معينة.

**منطق الأعمال والتحققات**:
- التحقق من وجود التقرير المحدد
- التحقق من صلاحية المستخدم لتشغيل التقرير
- التحقق من صحة معايير التنفيذ
- إنشاء سجل تنفيذ جديد
- تحضير استعلامات البيانات بناء على المعايير
- تنفيذ استعلامات البيانات وتجميع النتائج
- معالجة البيانات وتنسيقها وفق إعدادات العرض
- تخزين نتائج التقرير
- تحديث معلومات التنفيذ والإحصائيات
- إرجاع نتائج التقرير أو معرف التنفيذ

#### ScheduleReportCommand (أمر جدولة تقرير)
إعداد جدولة لتنفيذ تقرير بشكل دوري.

**منطق الأعمال والتحققات**:
- التحقق من وجود التقرير المحدد
- التحقق من صلاحية المستخدم لجدولة التقرير
- التحقق من صحة إعدادات الجدولة
- إنشاء سجل جدولة جديد أو تحديث جدولة موجودة
- حساب موعد التنفيذ القادم بناءً على إعدادات التكرار
- تكوين مهمة في جدول المهام لتنفيذ التقرير
- ربط إعدادات الإشعارات بالجدولة
- إعادة معرف الجدولة المنشأة

#### ShareReportCommand (أمر مشاركة تقرير)
مشاركة تقرير مع مستخدمين آخرين.

**منطق الأعمال والتحققات**:
- التحقق من وجود التقرير المحدد
- التحقق من صلاحية المستخدم لمشاركة التقرير
- التحقق من وجود المستخدمين المستهدفين وصلاحياتهم للوصول
- إنشاء سجلات اشتراك للمستخدمين المحددين
- إنشاء إشعارات للمستخدمين المشارك معهم
- تسجيل عملية المشاركة في سجل النشاط
- إرجاع قائمة بمعرفات الاشتراكات المنشأة

#### ExportReportCommand (أمر تصدير تقرير)
تصدير نتائج تقرير بتنسيق محدد.

**منطق الأعمال والتحققات**:
- التحقق من وجود نتائج التقرير المحدد
- التحقق من صلاحية المستخدم لتصدير التقرير
- التحقق من صحة التنسيق المطلوب
- تحويل نتائج التقرير إلى التنسيق المطلوب
- إنشاء الملف المطلوب وتخزينه
- تسجيل عملية التصدير في سجل النشاط
- إرجاع مسار الملف المصدر أو البيانات المصدرة

#### UpdateReportCriteriaCommand (أمر تحديث معايير التقرير)
تحديث معايير تقرير صلاحيات موجود.

**منطق الأعمال والتحققات**:
- التحقق من وجود التقرير المحدد
- التحقق من صلاحية المستخدم لتعديل التقرير
- التحقق من صحة المعايير الجديدة
- تحديث سجل التقرير بالمعايير الجديدة
- زيادة رقم نسخة التقرير
- تسجيل التغييرات في سجل النشاط
- إعادة معرف التقرير المحدث

### الاستعلامات (Queries)

#### GetPermissionReportByIdQuery (استعلام للحصول على تقرير بالمعرف)
استرجاع تفاصيل تقرير صلاحيات محدد بواسطة المعرف.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم للوصول للتقرير
- التحقق من وجود التقرير
- استرجاع معلومات التقرير الأساسية
- استرجاع المعايير وإعدادات العرض
- استرجاع معلومات الجدولة والاشتراكات المرتبطة
- إرجاع كائن التقرير كامل المعلومات

#### ListPermissionReportsQuery (استعلام لعرض قائمة التقارير)
استرجاع قائمة بتقارير الصلاحيات حسب معايير محددة.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم للوصول للتقارير
- تطبيق معايير التصفية (نوع التقرير، التصنيف، التاريخ)
- تطبيق معايير الفرز والترتيب
- تطبيق الصفحات (Pagination) للنتائج الكبيرة
- تصفية النتائج حسب صلاحيات المستخدم
- إرجاع قائمة التقارير مع المعلومات الأساسية

#### GetReportExecutionHistoryQuery (استعلام لعرض تاريخ تنفيذ التقرير)
استرجاع سجل تنفيذ تقرير محدد.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم للوصول للتقرير
- التحقق من وجود التقرير
- استرجاع سجلات تنفيذ التقرير
- تطبيق معايير التصفية (النجاح/الفشل، الفترة الزمنية)
- تطبيق معايير الفرز والترتيب
- إرجاع قائمة بسجلات التنفيذ مع المعلومات ذات الصلة

#### GetReportResultQuery (استعلام لعرض نتائج التقرير)
استرجاع نتائج تنفيذ تقرير محدد.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم للوصول للتقرير
- التحقق من وجود سجل التنفيذ
- استرجاع نتائج التقرير المخزنة
- معالجة النتائج وتنسيقها حسب متطلبات العرض
- تطبيق التصفية والفرز على النتائج إذا لزم الأمر
- إرجاع نتائج التقرير بالتنسيق المطلوب

#### GetScheduledReportsQuery (استعلام لعرض التقارير المجدولة)
استرجاع قائمة بالتقارير المجدولة للتنفيذ.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم للوصول للتقارير المجدولة
- تطبيق معايير التصفية (الحالة، التاريخ، نوع التكرار)
- تطبيق معايير الفرز والترتيب
- تصفية النتائج حسب صلاحيات المستخدم
- إرجاع قائمة بالتقارير المجدولة مع معلومات الجدولة

#### GetUserSubscriptionsQuery (استعلام لعرض اشتراكات المستخدم)
استرجاع قائمة بالتقارير المشترك بها المستخدم.

**منطق الأعمال والتحققات**:
- التحقق من صلاحية المستخدم
- تطبيق معايير التصفية (نوع الاشتراك، حالة الاشتراك)
- تطبيق معايير الفرز والترتيب
- استرجاع معلومات التقارير المرتبطة بالاشتراكات
- إرجاع قائمة بالاشتراكات مع المعلومات ذات الصلة

## اختصارات لوحة المفاتيح وأزرار الشاشة السريعة

### اختصارات لوحة المفاتيح
- **F1**: عرض المساعدة والتوثيق الخاص بشاشة تقارير الصلاحيات
- **F2**: إنشاء تقرير جديد
- **F3**: فتح التقرير المحدد للتعديل
- **F4**: تحديث قائمة التقارير
- **F5**: تشغيل التقرير المحدد
- **F6**: إظهار/إخفاء معايير التقرير
- **F7**: فتح شاشة الجدولة للتقرير المحدد
- **F8**: تصدير نتائج التقرير
- **F9**: طباعة التقرير
- **F10**: إظهار الرسوم البيانية للتقرير
- **Ctrl+N**: إنشاء تقرير جديد
- **Ctrl+O**: فتح تقرير موجود
- **Ctrl+S**: حفظ التقرير الحالي
- **Ctrl+P**: طباعة التقرير
- **Ctrl+F**: البحث في نتائج التقرير
- **Ctrl+E**: تصدير التقرير
- **Ctrl+R**: تشغيل التقرير
- **Ctrl+L**: عرض سجل تنفيذ التقرير
- **Ctrl+T**: إضافة التقرير للمفضلة
- **Alt+F4**: إغلاق الشاشة
- **Ctrl+Shift+S**: حفظ التقرير باسم جديد

### أزرار الشاشة السريعة
- **زر إنشاء تقرير**: إنشاء تقرير صلاحيات جديد
- **زر فتح تقرير**: فتح تقرير موجود
- **زر حفظ**: حفظ التقرير الحالي
- **زر تشغيل**: تشغيل التقرير المحدد
- **زر تحديث**: تحديث قائمة التقارير
- **زر طباعة**: طباعة التقرير
- **زر تصدير**: تصدير نتائج التقرير
- **زر مشاركة**: مشاركة التقرير مع مستخدمين آخرين
- **زر جدولة**: فتح شاشة جدولة تنفيذ التقرير
- **زر الرسوم البيانية**: عرض الرسوم البيانية للتقرير
- **زر خيارات العرض**: ضبط خيارات عرض التقرير
- **زر المفضلة**: إضافة/إزالة التقرير من المفضلة
- **زر سجل التنفيذ**: عرض سجل تنفيذ التقرير
- **زر المساعدة**: عرض مساعدة حول الشاشة
- **زر البحث**: البحث عن تقارير أو في نتائج التقرير
- **زر إضافة للمجلد**: إضافة التقرير إلى مجلد محدد
- **زر نسخة جديدة**: إنشاء نسخة جديدة من التقرير الحالي

## ملاحظات تقنية إضافية

1. **أمان البيانات والصلاحيات**:
   - يتم تطبيق تصفية البيانات حسب صلاحيات المستخدم في كل الاستعلامات
   - تشفير المعايير وإعدادات العرض المخزنة لمنع العبث بها
   - تسجيل جميع عمليات الوصول والتنفيذ للتقارير في سجل المراجعة
   - تنفيذ فحص الصلاحيات متعدد المستويات قبل الوصول للبيانات
   - دعم الوصول الجزئي للبيانات بناءً على صلاحيات المستخدم

2. **أداء وتحسين النظام**:
   - استخدام التخزين المؤقت (Caching) لنتائج التقارير المتكررة
   - تنفيذ الاستعلامات بشكل متوازٍ عند الإمكان
   - تقسيم معالجة البيانات الكبيرة إلى أجزاء قابلة للإدارة
   - جدولة التقارير الثقيلة في أوقات انخفاض الحمل على النظام
   - تحسين استعلامات قاعدة البيانات للتقارير المعقدة
   - تطبيق محدودية على حجم البيانات للتقارير التفاعلية

3. **تجربة المستخدم والواجهة**:
   - واجهة تفاعلية سهلة الاستخدام مع استجابة سريعة
   - دعم السحب والإفلات لتخصيص تنسيق التقارير
   - تصميم متجاوب يعمل على مختلف الأجهزة والشاشات
   - دعم النمط الداكن والإعدادات المرئية المخصصة
   - مساعدة سياقية وتلميحات مدمجة في الواجهة
   - حفظ إعدادات المستخدم وتفضيلاته للتقارير المختلفة

4. **قابلية التوسع والتكامل**:
   - هيكلية مرنة تسمح بإضافة أنواع جديدة من التقارير
   - واجهات برمجية (APIs) للتكامل مع الأنظمة الخارجية
   - دعم إضافة خوارزميات تحليل مخصصة للصلاحيات
   - إمكانية تخصيص قوالب التقارير وأنماط العرض
   - دعم التكامل مع أدوات تحليل البيانات الخارجية
   - هيكل بيانات قابل للتوسع لاستيعاب متطلبات مستقبلية

5. **إدارة الخطأ والاسترداد**:
   - آليات استرداد متقدمة لتنفيذ التقارير
   - معالجة منظمة للأخطاء مع رسائل مفصلة للمستخدم
   - سجل تفصيلي للأخطاء لتسهيل التشخيص والإصلاح
   - حفظ الحالة التلقائي للتقارير قيد الإنشاء أو التعديل
   - آليات لإعادة محاولة تنفيذ التقارير الفاشلة تلقائياً
   - دعم استرداد الجلسة في حالة انقطاع الاتصال